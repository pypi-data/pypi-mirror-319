import{p as Ue,f as qe,g as ge,i as We,n as h,x as Z,y as s,z as u,q as re,G as m,I as oe,a2 as N,ae as Ie,c as Q,aC as K,A as n,D as k,M as A,B as E,J as p,aD as Se,S,K as f,aA as Be,ak as J,aE as je,R as X,al as W,X as q,U as Je,aa as Qe,a9 as Ze,H as I,Y as xe,r as F,b as pe,w as H,o as et,v as fe,az as tt,aF as at,F as ve,E as ye,av as he}from"./index-CFvoaD7J.js";import{M as _e,h as Ae,c as U,s as lt}from"./ItemContextMenu.vue_vue_type_style_index_0_scoped_4409cede_lang-41DbVClm.js";import{_ as it}from"./ProviderIcon.vue_vue_type_script_setup_true_lang-Ji67J6Pu.js";import{B as Ce,L as ot}from"./ListItem-nYGtvGaY.js";import{V as $e}from"./VCheckbox-B5r7QKHZ.js";import{V as se}from"./VTooltip-DC73AT2B.js";import{a as st,p as nt,d as rt,r as ut,z as mt,A as dt,w as P,V as ct,D as pt,E as j,k as ft,v as ne}from"./VListItem-CSPID7yq.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as vt,a as yt}from"./VCard-DxLPF-Ra.js";import{e as ht}from"./VMenu-9pSrU4Fo.js";import{V as bt}from"./VSpacer-UYEiyhN7.js";import{V as kt,P as wt}from"./PanelviewItemCompact-BQIsDE0n.js";import{C as gt}from"./Container-BDz3QMuX.js";import{T as It}from"./Toolbar-DNen7a-V.js";import{V as St}from"./VTextField-DF4u_eMy.js";import{V as Bt}from"./VList-fGk9SRdf.js";import{a as _t,V as At}from"./VInfiniteScroll-D1yVLjQf.js";import{V as be,a as ke}from"./VRow-BC1No8oB.js";import{V as Ct}from"./VVirtualScroll-BDBVEoUv.js";import{V as we}from"./VAlert-CIiIOQza.js";const Fe=Symbol.for("vuetify:v-item-group"),$t=Ue({...st(),...nt({selectedClass:"v-item--selected"}),...rt(),...qe()},"VItemGroup"),Te=ge()({name:"VItemGroup",props:$t(),emits:{"update:modelValue":B=>!0},setup(B,a){let{slots:b}=a;const{themeClasses:g}=We(B),{isSelected:l,select:w,next:C,prev:T,selected:e}=ut(B,Fe);return()=>h(B.tag,{class:["v-item-group",g.value,B.class],style:B.style},{default:()=>{var v;return[(v=b.default)==null?void 0:v.call(b,{isSelected:l,select:w,next:C,prev:T,selected:e.value})]}})}}),L=ge()({name:"VItem",props:mt(),emits:{"group:selected":B=>!0},setup(B,a){let{slots:b}=a;const{isSelected:g,select:l,toggle:w,selectedClass:C,value:T,disabled:e}=dt(B,Fe);return()=>{var v;return(v=b.default)==null?void 0:v.call(b,{isSelected:g.value,selectedClass:C.value,select:l,toggle:w,value:T.value,disabled:e.value})}}}),Ve=Z({__name:"FavoriteButton",props:{item:{}},setup(B){const a=B;return(b,g)=>{var l;return s(),u(Ce,re(a,{variant:"list",icon:(l=b.item)!=null&&l.favorite?"mdi-heart":"mdi-heart-outline",title:b.$t("tooltip.favorite"),onClick:[g[0]||(g[0]=w=>m(oe).toggleFavorite(b.item)),g[1]||(g[1]=N(()=>{},["prevent"])),g[2]||(g[2]=N(()=>{},["stop"]))]}),null,16,["icon","title"])}}}),Ft={key:0,class:"media-thumb listitem-media-thumb"},Tt={key:1,class:"media-thumb listitem-media-thumb"},Vt={key:0},Ot={key:1},Dt={key:0},Pt={key:0,class:"line-clamp-1"},Lt={key:1},Mt={key:0},Rt={key:1},Et={key:2},Kt={key:3},Nt={key:4},Yt={key:0},zt={key:1},Xt={key:2},Gt={key:3},Ht={key:5},Ut={key:4},qt={key:5},Wt={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},jt=Z({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean}},emits:["menu","click","select"],setup(B,{emit:a}){const{t:b}=Ie(),g=B,l=Q(()=>{if(!("provider_mappings"in g.item))return"";for(const e of g.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),w=a,C=function(e){const v="clientX"in e?e.clientX:e.touches[0].clientX,y="clientY"in e?e.clientY:e.touches[0].clientY;w("menu",g.item,v,y)},T=function(e){g.showCheckboxes||w("click",g.item,e.clientX,e.clientY)};return(e,v)=>(s(),u(ot,{link:"","show-menu-btn":e.showMenu,class:q({unavailable:!e.isAvailable}),onClick:N(T,["stop"]),onMenu:N(C,["stop"])},{prepend:n(()=>[e.showCheckboxes?(s(),k("div",Ft,[h($e,{"model-value":e.isSelected,onClick:v[0]||(v[0]=N(()=>{},["stop"])),"onUpdate:modelValue":v[1]||(v[1]=y=>{y!=null&&w("select",e.item,y)})},null,8,["model-value"])])):(s(),k("div",Tt,[h(_e,{size:"50",item:e.isAvailable?e.item:void 0},null,8,["item"])]))]),title:n(()=>[e.item.media_type==m(A).FOLDER?(s(),k("span",Vt,[E("span",null,p(m(Se)(e.item,m(b))),1)])):(s(),k("span",Ot,[S(p(e.item.name)+" ",1),"version"in e.item&&e.item.version?(s(),k("span",Dt,"("+p(e.item.version)+")",1)):f("",!0)])),e.item&&e.item.metadata?(s(),u(m(se),{key:2,location:"bottom"},{activator:n(({props:y})=>[m(Be)(e.item.metadata.explicit||!1)?(s(),u(P,re({key:0},y,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):f("",!0)]),default:n(()=>[E("span",null,p(e.$t("tooltip.explicit")),1)]),_:1})):f("",!0)]),subtitle:n(()=>{var y;return[e.item.media_type==m(A).TRACK&&"provider_mappings"in e.item?(s(),k("div",Pt,[h(Te,null,{default:n(()=>["artists"in e.item?(s(),u(L,{key:0},{default:n(()=>[S(p(m(J)(e.item.artists,2)),1)]),_:1})):f("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(s(),u(L,{key:1},{default:n(()=>[S(" • "+p(e.item.album.name),1)]),_:1})):f("",!0),e.showDiscNumber&&"disc_number"in e.item&&e.item.disc_number?(s(),u(L,{key:2},{default:n(()=>[h(P,{style:{"margin-left":"5px"},icon:"md:album"}),S(" "+p(e.item.disc_number),1)]),_:1})):f("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(s(),u(L,{key:3},{default:n(()=>[h(P,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),S(" "+p(e.item.track_number),1)]),_:1})):e.showPosition&&"position"in e.item&&e.item.position?(s(),u(L,{key:4},{default:n(()=>[h(P,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),S(" "+p(e.item.position),1)]),_:1})):f("",!0)]),_:1})])):e.item.media_type==m(A).ALBUM&&"year"in e.item?(s(),k("div",Lt,[e.item.album_type!=m(je).UNKNOWN?(s(),k("span",Mt,p(e.$t("album_type."+e.item.album_type))+" • ",1)):f("",!0),E("span",null,p(m(J)(e.item.artists)),1),e.item.year?(s(),k("span",Rt," • "+p(e.item.year),1)):f("",!0)])):"artists"in e.item&&e.item.artists?(s(),k("div",Et,p(m(J)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(s(),k("div",Kt,p(e.item.owner),1)):"metadata"in e.item&&((y=e.item.metadata)!=null&&y.description)?(s(),k("div",Nt,[m(X)("bp6")?(s(),k("span",Yt,p(m(W)(e.item.metadata.description,300)),1)):m(X)("bp4")?(s(),k("span",zt,p(m(W)(e.item.metadata.description,200)),1)):m(X)("bp3")?(s(),k("span",Xt,p(m(W)(e.item.metadata.description,150)),1)):(s(),k("span",Gt,p(m(W)(e.item.metadata.description,80)),1))])):"media_type"in e.item&&!e.item.provider_mappings?(s(),k("div",Ht,p(e.$t(e.item.media_type)),1)):f("",!0)]}),append:n(()=>[l.value?(s(),u(ct,{key:0,src:m(Ae),width:"30",class:q(e.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:n(()=>[h(m(se),{activator:"parent",location:"bottom"},{default:n(()=>[S(p(l.value),1)]),_:1})]),_:1},8,["src","class"])):f("",!0),m(X)("bp2")&&e.showProvider?(s(),u(it,{key:1,domain:e.item.media_type==m(A).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):f("",!0),"fully_played"in e.item&&e.item.fully_played?(s(),u(P,{key:2,title:e.$t("item_fully_played")},{default:n(()=>v[2]||(v[2]=[S("mdi-check")])),_:1},8,["title"])):"resume_position_ms"in e.item&&e.item.resume_position_ms?(s(),u(P,{key:3,title:e.$t("item_in_progress")},{default:n(()=>v[3]||(v[3]=[S("mdi-clock-fast")])),_:1},8,["title"])):f("",!0),m(X)("bp3")&&"favorite"in e.item&&e.showFavorite&&!e.$vuetify.display.mobile?(s(),k("div",Ut,[h(Ve,{item:e.item},null,8,["item"])])):f("",!0),e.showDuration&&"duration"in e.item&&e.item.duration&&m(X)("bp0")?(s(),k("div",qt,[E("div",null,[E("span",Wt,p(m(Je)(e.item.duration)),1)])])):f("",!0)]),_:1},8,["show-menu-btn","class"]))}}),Jt=ue(jt,[["__scopeId","data-v-4a51bdc5"]]),Qt={key:0},Zt={key:1},xt={key:2},ea=["src"],ta={key:0},aa=Z({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0}},emits:["menu","click","play","select"],setup(B,{emit:a}){const b=B,g=Q(()=>{for(const e of b.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),l=a,w=function(e){if(b.showCheckboxes)return;const v="clientX"in e?e.clientX:e.touches[0].clientX,y="clientY"in e?e.clientY:e.touches[0].clientY;l("menu",b.item,v,y)},C=function(e){if(b.showCheckboxes){l("select",b.item,!b.isSelected);return}l("click",b.item,e.clientX,e.clientY)},T=function(e){b.showCheckboxes||l("play",b.item,e.clientX,e.clientY)};return(e,v)=>{const y=Qe("hold");return s(),u(kt,null,{default:n(({isHovering:$,props:M})=>[Ze((s(),u(vt,re(M,{tile:"",hover:"",class:["panel-item",{unavailable:!e.isAvailable}],onClick:C,onContextmenu:N(w,["right","prevent"])}),{default:n(()=>[e.showCheckboxes?(s(),u(ht,{key:0,"model-value":e.showCheckboxes,contained:"",scrim:e.isSelected?e.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:n(()=>[h($e,{class:"panel-item-checkbox",ripple:!1,"model-value":e.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):f("",!0),h(_e,{item:e.isAvailable?e.item:void 0,style:{height:"auto"}},null,8,["item"]),h(ft,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:n(()=>[h(pt,null,{default:n(()=>[e.item.media_type==m(A).FOLDER?(s(),k("span",Qt,[E("span",null,p(m(Se)(e.item,e.$t)),1)])):(s(),k("span",Zt,p(e.item.name),1)),"version"in e.item&&e.item.version?(s(),k("span",xt," - "+p(e.item.version),1)):f("",!0)]),_:1}),"artists"in e.item&&e.item.artists?(s(),u(j,{key:0,class:"line-clamp-1"},{default:n(()=>[S(p(m(J)(e.item.artists,1)),1)]),_:1})):"owner"in e.item&&e.item.owner?(s(),u(j,{key:1,class:"line-clamp-1"},{default:n(()=>[S(p(e.item.owner),1)]),_:1})):e.showMediaType?(s(),u(j,{key:2,class:"line-clamp-1"},{default:n(()=>[S(p(e.$t(e.item.media_type)),1)]),_:1})):(s(),u(j,{key:3,class:"line-clamp-1"}))]),_:1}),($||m(I).isTouchscreen)&&e.isAvailable?(s(),u(ne,{key:1,icon:"mdi-play",color:"primary",fab:"",style:xe(`position: absolute; right: 15px; bottom: ${e.showActions?90:35}px; opacity: 0.8`),onClick:N(T,["stop"])},null,8,["style"])):f("",!0),e.showActions?(s(),u(yt,{key:2,class:"panel-item-actions"},{default:n(()=>[h(Te,{style:{padding:"0"}},{default:n(()=>[m(Be)(e.item.metadata.explicit||!1)?(s(),u(L,{key:0},{default:n(()=>[h(P,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):f("",!0),g.value?(s(),u(L,{key:1},{default:n(()=>[h(P,{class:q(e.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:n(()=>[E("img",{src:m(Ae),width:"30"},null,8,ea),h(se,{activator:"parent",location:"bottom"},{default:n(()=>[S(p(g.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):f("",!0),"track_number"in e.item&&e.item.track_number?(s(),u(L,{key:2},{default:n(()=>[h(P,{size:"small",icon:"mdi-music-circle-outline"}),e.item.disc_number?(s(),k("span",ta,p(e.item.disc_number)+"/",1)):f("",!0),S(p(e.item.track_number),1)]),_:1})):"position"in e.item&&e.item.position?(s(),u(L,{key:3},{default:n(()=>[h(P,{size:"small",icon:"mdi-music-circle-outline"}),S(" "+p(e.item.position),1)]),_:1})):f("",!0),m(X)("bp3")?(s(),u(L,{key:4},{default:n(()=>[h(Ve,{item:e.item},null,8,["item"])]),_:1})):f("",!0)]),_:1}),h(bt),$||e.$vuetify.display.mobile?(s(),u(Ce,{key:0,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:v[0]||(v[0]=N(V=>e.$emit("menu",e.item,V.clientX,V.clientY),["stop"]))})):f("",!0)]),_:2},1024)):f("",!0)]),_:2},1040,["class"])),[[y,w]])]),_:1})}}}),la=ue(aa,[["__scopeId","data-v-ae37b069"]]),ia={key:0},oa={key:1},sa=Z({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(oe.providers).length>1},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1}},setup(B){const a=B,b=tt(),{t:g}=Ie(),l=F({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),w=F("list"),C=F(!1),T=F(!1),e=F([]),v=F([]),y=F(!1),$=F([]),M=F(!1),V=F(!1),Y=F(!0),R=F(!1),G=F(!1),x=F(!1),Oe=function(){C.value?C.value=!1:(C.value=!0,fe(()=>{var t;(t=document.getElementById("searchInput"))==null||t.focus()}))},ee=function(){Y.value=!Y.value,localStorage.setItem(`expand.${a.path}.${a.itemtype}`,Y.value.toString())},te=function(t){w.value=t,localStorage.setItem(`viewMode.${a.path}.${a.itemtype}`,t)},De=function(){l.value.favoritesOnly=!l.value.favoritesOnly;const t=l.value.favoritesOnly?"true":"false";localStorage.setItem(`favoriteFilter.${a.path}.${a.itemtype}`,t),O(void 0,void 0,!0)},Pe=function(){l.value.libraryOnly=!l.value.libraryOnly;const t=l.value.libraryOnly?"true":"false";localStorage.setItem(`libraryFilter.${a.path}.${a.itemtype}`,t),O(!0,void 0,!0)},Le=function(){l.value.albumArtistsFilter=!l.value.albumArtistsFilter;const t=l.value.albumArtistsFilter?"true":"false";localStorage.setItem(`albumArtistsFilter.${a.path}.${a.itemtype}`,t),O(void 0,void 0,!0)},ae=function(t){return $.value.includes(t)},le=function(t,o){if(o)$.value.includes(t)||$.value.push(t);else for(let i=0;i<$.value.length;i++)$.value[i]===t&&$.value.splice(i,1)},Me=function(){V.value&&($.value=[]),V.value=!V.value},Re=function(){O(!0,!0)},z=function(t,o,i){const d=Array.isArray(t)?t:[t];d[0].media_type!=A.FOLDER&&lt(d,a.parentItem,o,i)},ie=function(t,o,i){if(!U(t)){z(t,o,i);return}t.media_type==A.FOLDER?b.push({name:"browse",query:{path:t.path}}):w.value=="list"&&[A.TRACK,A.PODCAST_EPISODE].includes(t.media_type)&&a.parentItem?z(t,o,i):b.push({name:t.media_type,params:{itemId:t.item_id,provider:t.provider}})},me=function(t,o,i){if(!U(t)){z(t,o,i);return}if(!I.activePlayerId){I.showPlayersMenu=!0;return}oe.playMedia(t.uri,void 0)},Ee=function(){l.value.search="",C.value=!1,O(void 0,void 0,!0)},Ke=function(t){t!==void 0&&(l.value.sortBy=t),localStorage.setItem(`sortBy.${a.path}.${a.itemtype}`,l.value.sortBy),O(void 0,void 0,!0)},Ne=function(t){var o,i;(o=l.value.albumType)!=null&&o.includes(t)?l.value.albumType=(i=l.value.albumType)==null?void 0:i.filter(d=>d!==t):(l.value.albumType=l.value.albumType||[],l.value.albumType.push(t)),localStorage.setItem(`albumType.${a.path}.${a.itemtype}`,l.value.albumType.join(",")),O(void 0,void 0,!0)},Ye=function(){I.globalSearchTerm=l.value.search,a.itemtype=="artists"?I.globalSearchType=A.ARTIST:a.itemtype=="albums"?I.globalSearchType=A.ALBUM:a.itemtype=="tracks"?I.globalSearchType=A.TRACK:a.itemtype=="playlists"?I.globalSearchType=A.PLAYLIST:a.itemtype=="audiobooks"?I.globalSearchType=A.AUDIOBOOK:a.itemtype=="podcasts"?I.globalSearchType=A.PODCAST:a.itemtype=="radios"&&(I.globalSearchType=A.RADIO),b.push({name:"search"})},ze=function({done:t}){if(R.value){t("empty");return}O(void 0,void 0,void 0,l.value.offset+a.limit).then(()=>{t("ok")})},de=Q(()=>{var t=!1;return l.value.search&&l.value.search.length!==0&&(t=!0),t}),Xe=Q(()=>{var o,i;if(a.allowCollapse===!0&&!Y.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:ee,overflowAllowed:!1}];const t=[];return a.showSelectButton!==!1&&t.push({label:"tooltip.select_items",icon:V.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:Me,active:V.value}),a.showLibraryOnlyFilter===!0&&t.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:Pe,active:l.value.libraryOnly}),a.showFavoritesOnlyFilter===!0&&t.push({label:"tooltip.filter_favorites",icon:l.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:De,active:l.value.favoritesOnly}),a.showAlbumArtistsOnlyFilter===!0&&t.push({label:"tooltip.album_artist_filter",icon:l.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:Le,active:l.value.albumArtistsFilter}),a.showAlbumTypeFilter&&t.push({label:"tooltip.album_type",icon:"mdi-album",disabled:y.value,subItems:["album","single","ep","compilation","unknown"].map(d=>{var _;return{label:`album_type.${d}`,selected:(_=l.value.albumType)==null?void 0:_.includes(d),action:()=>{Ne(d)}}})}),(a.showRefreshButton!==!1||M.value)&&t.push({label:M.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:Re,active:M.value,disabled:y.value}),(o=a.sortKeys)!=null&&o.length&&t.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:a.sortKeys.length<=1||y.value,subItems:a.sortKeys.map(d=>({label:`sort.${d}`,selected:l.value.sortBy==d,action:()=>{Ke(d)}}))}),a.showSearchButton!==!1&&t.push({label:de.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Oe,active:de.value,disabled:y.value}),t.push({label:"tooltip.toggle_view_mode",icon:w.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:w.value=="list",action:()=>{te("list")}},{label:"view.panel",icon:"mdi-grid",selected:w.value=="panel",action:()=>{te("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:w.value=="panel_compact",action:()=>{te("panel_compact")}}]}),(i=a.extraMenuItems)!=null&&i.length&&t.push(...a.extraMenuItems),a.allowCollapse===!0&&t.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:ee}),t}),O=async function(t=!1,o=!1,i=!1,d=0){if(!y.value){if(y.value=!0,i&&a.loadPagedData!=null&&(t=!0),(t||o)&&(d=0,R.value&&(x.value=!0),R.value=!1,G.value=!1,M.value=!1),l.value.offset=d,l.value.limit=a.limit,l.value.refresh=o,a.loadPagedData!=null){const _=await a.loadPagedData(l.value);l.value.offset?e.value.push(..._):e.value=_,Math.abs(_.length-a.limit)>10&&(R.value=!0)}else if(a.loadItems!=null){(!G.value||o)&&(v.value=await a.loadItems(l.value),G.value=!0);const _=He(v.value,l.value);l.value.offset?e.value.push(..._):e.value=_,R.value=_.length<a.limit}l.value.refresh=!1,y.value=!1,x.value=!1}},Ge=async function(){const t=a.itemtype||a.path,o=localStorage.getItem(`viewMode.${t}`);o&&o!=="null"?w.value=o:a.itemtype=="artists"||a.itemtype=="albums"?w.value="panel":w.value="list";const i=localStorage.getItem(`sortBy.${t}`);if(i&&i!=="null"&&a.sortKeys.includes(i)?l.value.sortBy=i:l.value.sortBy=a.sortKeys[0],a.showFavoritesOnlyFilter!==!1){const d=localStorage.getItem(`favoriteFilter.${t}`);d&&d=="true"&&(l.value.favoritesOnly=!0)}if(a.showLibraryOnlyFilter!==!1){const d=localStorage.getItem(`libraryFilter.${t}`);d&&d=="true"&&(l.value.libraryOnly=!0)}if(a.showAlbumArtistsOnlyFilter!==!1){const d=localStorage.getItem(`albumArtistsFilter.${t}`);d&&(l.value.albumArtistsFilter=d=="true")}if(a.allowCollapse!==!1){const d=localStorage.getItem(`expand.${t}`);d&&(Y.value=d=="true")}if(a.showAlbumTypeFilter===!0){const d=localStorage.getItem(`albumType.${t}`);d&&(l.value.albumType=d.split(","))}if(a.restoreState){let d=`search.${t}`;a.parentItem&&(d+=a.parentItem.item_id);const _=localStorage.getItem(d);_&&_!=="null"&&(l.value.search=_)}},ce=function(t){I.dialogActive||y.value||(t.key==="a"&&(t.ctrlKey||t.metaKey)?(t.preventDefault(),$.value=e.value,V.value=!0):!T.value&&t.key=="Backspace"?l.value.search=l.value.search.slice(0,-1):!T.value&&t.key.length==1&&(l.value.search+=t.key,C.value=!0))};a.allowKeyHooks&&(document.addEventListener("keydown",ce),pe(()=>{document.removeEventListener("keydown",ce)})),a.restoreState&&pe(()=>{const t=a.path||a.itemtype,o=document.querySelector("#cont");I.prevState={path:t,scrollPos:(o==null?void 0:o.scrollTop)||0,pagedItems:e.value,allItems:v.value,allItemsReceived:R.value,initialDataReceived:G.value,params:l.value}}),H(()=>l.value.search,t=>{t&&(C.value=!0),O(void 0,void 0,!0);let o=`search.${a.path}.${a.itemtype}`;a.parentItem&&(o+=a.parentItem.item_id),localStorage.setItem(o,l.value.search)}),H(()=>a.path,t=>{y.value!=!0&&(e.value=[],v.value=[],O(!0))}),H(()=>a.parentItem,()=>{y.value!=!0&&(v.value=[],M.value=!0)},{deep:!0}),H(()=>a.limit,t=>{l.value.limit=t}),H(()=>a.updateAvailable,t=>{y.value||(M.value=t)},{immediate:!0}),et(async()=>{var o;Ge();const t=a.path||a.itemtype;a.restoreState&&((o=I.prevState)==null?void 0:o.path)==t?(l.value=I.prevState.params,e.value=I.prevState.pagedItems,v.value=I.prevState.allItems,R.value=I.prevState.allItemsReceived,G.value=I.prevState.initialDataReceived,fe(()=>{const i=document.getElementById("cont");i&&at(i,I.prevState.scrollPos,50)}),y.value=!1):O(!0)});const D=function(t,o=!1){return t?"label"in t&&t.label&&t.name?g(t.label,[t.name]):"label"in t&&t.label?g(t.label):o&&"sort_name"in t&&t.sort_name?t.sort_name:t.name:""},He=function(t,o){var d,_;let i=[];if(o.search){const c=o.search.toLowerCase();for(const r of t)(r.name.toLowerCase().includes(c)||"artist"in r&&((d=r.artist)!=null&&d.name.toLowerCase().includes(c))||"album"in r&&((_=r.album)!=null&&_.name.toLowerCase().includes(c))||"artists"in r&&r.artists&&r.artists.length&&r.artists[0].name.toLowerCase().includes(c))&&i.push(r)}else i=[...t];return o.sortBy=="name"&&i.sort((c,r)=>D(c).localeCompare(D(r),void 0,{numeric:!0})),o.sortBy=="sort_name"&&i.sort((c,r)=>D(c,!0).localeCompare(D(r,!0),void 0,{numeric:!0})),o.sortBy=="name_desc"&&i.sort((c,r)=>D(r).localeCompare(D(c),void 0,{numeric:!0})),o.sortBy=="album"&&i.sort((c,r)=>D(c.album).localeCompare(D(r.album),void 0,{numeric:!0})),o.sortBy=="artist"&&i.sort((c,r)=>D(c.artists[0]).localeCompare(D(r.artists[0]))),o.sortBy=="track_number"&&(i.sort((c,r)=>(c.track_number||0)-(r.track_number||0)),i.sort((c,r)=>(c.disc_number||0)-(r.disc_number||0))),o.sortBy=="position"&&i.sort((c,r)=>(c.position||0)-(r.position||0)),o.sortBy=="position_desc"&&i.sort((c,r)=>(r.position||0)-(c.position||0)),o.sortBy=="year"&&i.sort((c,r)=>(c.year||0)-(r.year||0)),o.sortBy=="recent"&&i.sort((c,r)=>(r.timestamp_added||0)-(c.timestamp_added||0)),o.sortBy=="duration"&&i.sort((c,r)=>(c.duration||0)-(r.duration||0)),o.sortBy=="duration_desc"&&i.sort((c,r)=>(r.duration||0)-(c.duration||0)),o.sortBy=="provider"&&i.sort((c,r)=>c.provider.localeCompare(r.provider)),o.favoritesOnly&&(i=i.filter(c=>c.favorite)),o.albumType&&o.albumType.length>0&&(i=i.filter(c=>{var r;return(r=o.albumType)==null?void 0:r.includes(c.album_type)})),i.slice(o.offset,o.offset+o.limit)};return(t,o)=>t.hideOnEmpty&&e.value.length==0?f("",!0):(s(),k("section",ia,[h(It,{icon:t.icon,title:t.title,count:l.value.search?e.value.length:t.total||v.value.length,color:"transparent","menu-items":Xe.value,onTitleClicked:ee},null,8,["icon","title","count","menu-items"]),h(Bt),C.value&&Y.value?(s(),u(St,{key:0,id:"searchInput",modelValue:l.value.search,"onUpdate:modelValue":o[0]||(o[0]=i=>l.value.search=i),clearable:"","prepend-inner-icon":"mdi-magnify",label:t.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:o[1]||(o[1]=i=>T.value=!0),onBlur:o[2]||(o[2]=i=>T.value=!1),"onClick:clear":Ee},null,8,["modelValue","label"])):f("",!0),Y.value?(s(),u(gt,{key:1,variant:w.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:n(()=>[!x.value&&!(e.value.length==0&&R.value)?(s(),u(_t,{key:0,onLoad:ze,mode:t.infiniteScroll?"intersect":"manual","load-more-text":t.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:n(()=>[w.value=="panel"?(s(),u(be,{key:0},{default:n(()=>[(s(!0),k(ve,null,ye(e.value,i=>(s(),u(ke,{key:i.uri,cols:"12",class:q(`col-${m(he)(t.$vuetify.display.width)}`)},{default:n(()=>[h(la,{item:i,"is-selected":ae(i),"show-checkboxes":V.value,"show-actions":["tracks","albums"].includes(t.itemtype),"is-available":m(U)(i),onSelect:le,onMenu:z,onClick:ie,onPlay:me},null,8,["item","is-selected","show-checkboxes","show-actions","is-available"])]),_:2},1032,["class"]))),128))]),_:1})):f("",!0),w.value=="panel_compact"?(s(),u(be,{key:1},{default:n(()=>[(s(!0),k(ve,null,ye(e.value,i=>(s(),u(ke,{key:i.uri,cols:"12",class:q(`col-${m(he)(t.$vuetify.display.width)}`)},{default:n(()=>[h(wt,{item:i,"is-selected":ae(i),"show-checkboxes":V.value,"is-available":m(U)(i),onSelect:le,onMenu:z,onClick:ie,onPlay:me},null,8,["item","is-selected","show-checkboxes","is-available"])]),_:2},1032,["class"]))),128))]),_:1})):f("",!0),w.value=="list"?(s(),u(Ct,{key:2,"item-height":70,height:"100%",items:e.value,style:{height:"100%",overflow:"hidden"}},{default:n(({item:i})=>[h(Jt,{item:i,"show-track-number":t.showTrackNumber,"show-disc-number":t.showTrackNumber,"show-duration":t.showDuration,"show-favorite":t.showFavoritesOnlyFilter,"show-menu":t.showMenu,"show-provider":t.showProvider,"show-album":t.showAlbum,"show-checkboxes":V.value,"is-selected":ae(i),"is-available":m(U)(i),"show-details":t.itemtype.includes("versions"),onSelect:le,onMenu:z,onClick:ie},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","is-available","show-details"])]),_:1},8,["items"])):f("",!0)]),_:1},8,["mode","load-more-text"])):f("",!0),!y.value&&e.value.length==0?(s(),k("div",oa,[!y.value&&e.value.length==0&&(l.value.search||l.value.favoritesOnly)?(s(),u(we,{key:0,title:t.$t("no_content_filter")},{default:n(()=>[l.value.search?(s(),u(ne,{key:0,style:{"margin-top":"15px"},onClick:Ye},{default:n(()=>[S(p(t.$t("try_global_search")),1)]),_:1})):f("",!0)]),_:1},8,["title"])):!y.value&&e.value.length==0?(s(),u(we,{key:1},{default:n(()=>[S(p(t.$t("no_content")),1)]),_:1})):f("",!0)])):f("",!0),h(At,{"model-value":$.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:n(()=>[h(ne,{color:"primary",variant:"text",onClick:o[3]||(o[3]=i=>z($.value,i.clientX,i.clientY))},{default:n(()=>[S(p(t.$t("actions")),1)]),_:1})]),default:n(()=>[E("span",null,p(t.$t("items_selected",[$.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):f("",!0)]))}}),Ca=ue(sa,[["__scopeId","data-v-fe8eab83"]]);export{Ca as I};
