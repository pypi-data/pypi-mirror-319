
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Quick Start &#8212; yaflux  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'quick_start';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Design Philosophy" href="design.html" />
    <link rel="prev" title="Installation" href="installation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">yaflux  documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Quick Start
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="design.html">
    Design Philosophy
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="ast.html">
    Abstract Syntax Tree (AST)
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="advanced_usage.html">
    Advanced Usage
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="api/index.html">
    API Reference
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Quick Start
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="design.html">
    Design Philosophy
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="ast.html">
    Abstract Syntax Tree (AST)
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="advanced_usage.html">
    Advanced Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Quick Start</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="quick-start">
<h1>Quick Start<a class="headerlink" href="#quick-start" title="Link to this heading">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">yaflux</span></code> helps you manage complex analytical workflows in Python.
It provides a structured approach to tracking transformations, ensuring reproducibility, and maintaining clear provenance.
This quick start guide will show you how to define and run an analysis using <code class="docutils literal notranslate"><span class="pre">yaflux</span></code>.</p>
<section id="defining-an-analysis">
<h2>Defining an Analysis<a class="headerlink" href="#defining-an-analysis" title="Link to this heading">#</a></h2>
<p>Analyses in <code class="docutils literal notranslate"><span class="pre">yaflux</span></code> are defined as classes that inherit from <code class="docutils literal notranslate"><span class="pre">Base</span></code>.</p>
<p>The key components of an analysis are the individual steps that make up the workflow.
These steps are defined as methods within the analysis class and are decorated with <code class="docutils literal notranslate"><span class="pre">step</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">step</span></code> decorator allows you to specify the inputs and outputs of each step, as well as any dependencies between steps.</p>
<section id="example-analysis">
<h3>Example Analysis<a class="headerlink" href="#example-analysis" title="Link to this heading">#</a></h3>
<p>Here’s an example of an analysis class with three steps:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaflux</span> <span class="k">as</span> <span class="nn">yf</span>

<span class="k">class</span> <span class="nc">MyAnalysis</span><span class="p">(</span><span class="n">yf</span><span class="o">.</span><span class="n">Base</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An example analysis class.&quot;&quot;&quot;</span>

    <span class="c1"># Define analysis steps</span>
    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

    <span class="c1"># Specify dependencies between steps</span>
    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;processed_data&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span><span class="p">]</span>

    <span class="c1"># Combine results from previous steps</span>
    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;final_data&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span> <span class="s2">&quot;processed_data&quot;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">workflow_step_c</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">processed_data</span><span class="p">]</span>

<span class="c1"># Define and run an analysis</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">MyAnalysis</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>

<span class="c1"># Access results</span>
<span class="n">final</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">final_data</span>
</pre></div>
</div>
</section>
<section id="step-decorator">
<h3>Step Decorator<a class="headerlink" href="#step-decorator" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">step</span></code> decorator is used to define the individual steps of the analysis workflow.</p>
<p>It will automatically handle adding the results of the decorated method to the analysis object so you can focus on functional implementations.</p>
<section id="dependencies">
<h4>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading">#</a></h4>
<p>It takes the following arguments:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">creates</span></code>: The name of the result(s) created by the step (if any)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">requires</span></code>: The name(s) of the result(s) required by the step (if any)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mutates</span></code>: The names(s) of the result(s) that are mutated by the step (if any)</p></li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">creates</span></code> and <code class="docutils literal notranslate"><span class="pre">requires</span></code> arguments allow you to specify the inputs and outputs of each step.
The <code class="docutils literal notranslate"><span class="pre">mutates</span></code> argument allows you to specify which results are mutated in place by the step.</p>
<p>The decorated method should return the result(s) of the step.</p>
<p><strong>Note</strong>: The <code class="docutils literal notranslate"><span class="pre">mutates</span></code> argument implies a <code class="docutils literal notranslate"><span class="pre">requires</span></code> dependency. If a step mutates a result, it implicitly requires that result. If you include a variable in the <code class="docutils literal notranslate"><span class="pre">mutates</span></code> you do not need to include it in the <code class="docutils literal notranslate"><span class="pre">requires</span></code>.</p>
</section>
<section id="mutability">
<h4>Mutability<a class="headerlink" href="#mutability" title="Link to this heading">#</a></h4>
<p>Note that in the above example <strong>no step mutates the analysis object</strong>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">step</span></code> decorator ensures that the results of each step are properly stored and tracked by the analysis object.
This is an attempt to limit the potential for side effects and to make the analysis more reproducible.</p>
<p>There are cases however where you may need to mutate the internal state of specific results for efficiency reasons.
In these cases you can use the <code class="docutils literal notranslate"><span class="pre">mutates</span></code> argument to specify which results are mutated in place.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaflux</span> <span class="k">as</span> <span class="nn">yf</span>

<span class="k">class</span> <span class="nc">MyAnalysis</span><span class="p">(</span><span class="n">yf</span><span class="o">.</span><span class="n">Base</span><span class="p">):</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

    <span class="c1"># Mutating the raw_data in place</span>
    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">mutates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span> <span class="n">creates</span><span class="o">=</span><span class="s2">&quot;_mutated_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;final_data&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span> <span class="s2">&quot;_mutated_data&quot;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">workflow_step_c</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span><span class="p">)</span>

<span class="n">analysis</span> <span class="o">=</span> <span class="n">MyAnalysis</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">analysis</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">final_data</span> <span class="o">==</span> <span class="mi">90</span>
</pre></div>
</div>
<p>An important thing to note is that direct mutations break the implicit DAG structure of the analysis.
The way that <code class="docutils literal notranslate"><span class="pre">yaflux</span></code> reinforces the DAG structure of the analysis is by not allowing steps at the same topological level to have any overlap between mutated and required depdendencies.</p>
<p>Take the following example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaflux</span> <span class="k">as</span> <span class="nn">yf</span>

<span class="k">class</span> <span class="nc">MyAnalysis</span><span class="p">(</span><span class="n">yf</span><span class="o">.</span><span class="n">Base</span><span class="p">):</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">10</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">mutates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_b</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="mi">20</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">mutates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="mi">30</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;final_data&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_d</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">+</span> <span class="mi">10</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">MyAnalysis</span><span class="p">()</span>
<span class="k">except</span> <span class="n">yf</span><span class="o">.</span><span class="n">MutabilityConflictError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p>Because <code class="docutils literal notranslate"><span class="pre">workflow_step_b</span></code> and <code class="docutils literal notranslate"><span class="pre">workflow_step_c</span></code> both mutate <code class="docutils literal notranslate"><span class="pre">raw_data</span></code> and <code class="docutils literal notranslate"><span class="pre">workflow_step_d</span></code> requires <code class="docutils literal notranslate"><span class="pre">raw_data</span></code> this will raise a <code class="docutils literal notranslate"><span class="pre">MutabilityConflictError</span></code>.
The problem is that the <code class="docutils literal notranslate"><span class="pre">final_data</span></code> will change depending on the order of execution of <code class="docutils literal notranslate"><span class="pre">workflow_step_b</span></code> and <code class="docutils literal notranslate"><span class="pre">workflow_step_c</span></code>.
This is a problem because <code class="docutils literal notranslate"><span class="pre">yaflux</span></code> assumes that the order of execution of steps at the same topological level does not matter.</p>
<p>To fix this problem you can use flags to signify that a step has been run.</p>
</section>
<section id="flag-setting">
<h4>Flag Setting<a class="headerlink" href="#flag-setting" title="Link to this heading">#</a></h4>
<p>Sometimes theres no getting around mutating the internal state of the analysis object.
This might be because an operation may be significantly more efficient if it can be done in place.
However, you might still need to signify that a step has been run.
In this case you can use the flag syntax in the <code class="docutils literal notranslate"><span class="pre">creates</span></code> or <code class="docutils literal notranslate"><span class="pre">requires</span></code> arguments to signify that a step has been run.</p>
<p>Flags are set and required with a leading underscore.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaflux</span> <span class="k">as</span> <span class="nn">yf</span>

<span class="k">class</span> <span class="nc">MyAnalysis</span><span class="p">(</span><span class="n">yf</span><span class="o">.</span><span class="n">Base</span><span class="p">):</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

    <span class="c1"># Flag setting is specified with a leading underscore</span>
    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;_mut_data&quot;</span><span class="p">,</span> <span class="n">mutates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># mutate the raw_data</span>

    <span class="c1"># Flag requirements are specified with a leading underscore</span>
    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;final_data&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span> <span class="s2">&quot;_mut_data&quot;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">workflow_step_c</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span><span class="p">]</span>

<span class="n">analysis</span> <span class="o">=</span> <span class="n">MyAnalysis</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that the results are not <strong>reassigned</strong> but <strong>mutated</strong> in place.
<code class="docutils literal notranslate"><span class="pre">yaflux</span></code> will still not allow you to reassign the results of a step, but it will allow you to mutate them in place.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaflux</span> <span class="k">as</span> <span class="nn">yf</span>

<span class="k">class</span> <span class="nc">MyAnalysis</span><span class="p">(</span><span class="n">yf</span><span class="o">.</span><span class="n">Base</span><span class="p">):</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

    <span class="c1"># Flag setting is specified with a leading underscore</span>
    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;_mut_data&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span><span class="p">]</span> <span class="c1"># will fail</span>

    <span class="c1"># Flag requirements are specified with a leading underscore</span>
    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;final_data&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span> <span class="s2">&quot;_mut_data&quot;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">workflow_step_c</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span><span class="p">]</span>

<span class="n">analysis</span> <span class="o">=</span> <span class="n">MyAnalysis</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">workflow_step_a</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">workflow_step_b</span><span class="p">()</span> <span class="c1"># will fail</span>
</pre></div>
</div>
<p>Lets look at an example where we use flags to disambiguate the order of execution of steps:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaflux</span> <span class="k">as</span> <span class="nn">yf</span>

<span class="k">class</span> <span class="nc">MyAnalysis</span><span class="p">(</span><span class="n">yf</span><span class="o">.</span><span class="n">Base</span><span class="p">):</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">10</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">mutates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span> <span class="n">creates</span><span class="o">=</span><span class="s2">&quot;_flag_b&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_b</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="mi">20</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">mutates</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span> <span class="n">creates</span><span class="o">=</span><span class="s2">&quot;_flag_c&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="s2">&quot;_flag_b&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">workflow_step_c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">=</span> <span class="mi">30</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;final_data&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span> <span class="s2">&quot;_flag_b&quot;</span><span class="p">,</span> <span class="s2">&quot;_flag_c&quot;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">workflow_step_d</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">raw_data</span> <span class="o">+</span> <span class="mi">10</span>

<span class="n">analysis</span> <span class="o">=</span> <span class="n">MyAnalysis</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="executing-an-analysis">
<h2>Executing an Analysis<a class="headerlink" href="#executing-an-analysis" title="Link to this heading">#</a></h2>
<p>The benefit of using <code class="docutils literal notranslate"><span class="pre">yaflux</span></code> is that it automatically:</p>
<ol class="arabic simple">
<li><p>Tracks dependencies between steps</p></li>
<li><p>Ensures that each step is only run once</p></li>
<li><p>Provides a clear record of which steps have been completed</p></li>
</ol>
<p>This keeps your analysis organized and reproducible.
It also keeps you from inadvertently running the same step multiple times or running steps out of order.</p>
<section id="runtime-inference">
<h3>Runtime Inference<a class="headerlink" href="#runtime-inference" title="Link to this heading">#</a></h3>
<p>When you run an analysis, <code class="docutils literal notranslate"><span class="pre">yaflux</span></code> will automatically infer the correct order of execution based on the dependencies you’ve specified.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span> <span class="o">=</span> <span class="n">MyAnalysis</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</pre></div>
</div>
<p>You can also run up to a specific step:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span> <span class="o">=</span> <span class="n">MyAnalysis</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">target_step</span><span class="o">=</span><span class="s2">&quot;workflow_step_b&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="redundant-execution">
<h3>Redundant Execution<a class="headerlink" href="#redundant-execution" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">yaflux</span></code> will by default skip redundant execution of steps.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">step</span></code> method includes a <code class="docutils literal notranslate"><span class="pre">force</span></code> parameter that allows you to force the step to run again.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span> <span class="o">=</span> <span class="n">MyAnalysis</span><span class="p">()</span>

<span class="c1"># Run the first step</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">workflow_step_a</span><span class="p">()</span>

<span class="c1"># Try to run the first step again (skips execution)</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">workflow_step_a</span><span class="p">()</span>

<span class="c1"># Force the first step to run again</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">workflow_step_a</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Panic on redundant execution (raises an error)</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">workflow_step_a</span><span class="p">(</span><span class="n">panic_on_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="dependency-tracking">
<h3>Dependency Tracking<a class="headerlink" href="#dependency-tracking" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">yaflux</span></code> automatically tracks dependencies between steps.</p>
<p>This means that you can define the order of your analysis steps however you’d like.
<code class="docutils literal notranslate"><span class="pre">yaflux</span></code> will ensure that each step is only runnable once its dependencies have been met.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the first step</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">MyAnalysis</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">workflow_step_a</span><span class="p">()</span>

<span class="c1"># Try an invalid step (raises an error)</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">workflow_step_c</span><span class="p">()</span>

<span class="c1"># Run the second step</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">workflow_step_b</span><span class="p">()</span>

<span class="c1"># Run the third step (works because the second step has been run)</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">workflow_step_c</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="saving-and-loading-analysis-states">
<h2>Saving and Loading Analysis States<a class="headerlink" href="#saving-and-loading-analysis-states" title="Link to this heading">#</a></h2>
<p>One of the advantages of <code class="docutils literal notranslate"><span class="pre">yaflux</span></code> is the ability to save and load analysis states.
This allows you to easily share and reproduce analyses without having to rerun the entire workflow.</p>
<section id="saving">
<h3>Saving<a class="headerlink" href="#saving" title="Link to this heading">#</a></h3>
<p>We can easily save the analysis state to a file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can save the analysis state to a file</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;analysis.yax&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="loading">
<h3>Loading<a class="headerlink" href="#loading" title="Link to this heading">#</a></h3>
<section id="loading-with-original-class-definition">
<h4>Loading with Original Class Definition<a class="headerlink" href="#loading-with-original-class-definition" title="Link to this heading">#</a></h4>
<p>If you have access to the original class definition, you can load the analysis state as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaflux</span> <span class="k">as</span> <span class="nn">yf</span>

<span class="c1"># We can load the analysis state from a file</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">MyAnalysis</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;analysis.yax&quot;</span><span class="p">)</span>

<span class="c1"># Or load the analysis using the built-in load function</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;analysis.yax&quot;</span><span class="p">)</span>

<span class="c1"># Access results</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">final_data</span>

<span class="c1"># View metadata</span>
<span class="nb">print</span><span class="p">(</span><span class="n">analysis</span><span class="o">.</span><span class="n">available_steps</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">analysis</span><span class="o">.</span><span class="n">completed_steps</span><span class="p">)</span>

<span class="c1"># Rerun analysis from a specific step</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">workflow_step_b</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="loading-without-original-class-definition">
<h4>Loading without Original Class Definition<a class="headerlink" href="#loading-without-original-class-definition" title="Link to this heading">#</a></h4>
<p>A challenge with custom analysis classes is that some end users may not have access to the original class definition.</p>
<p><code class="docutils literal notranslate"><span class="pre">yaflux</span></code> provides a solution for this by allowing you to save and load analysis states without the original class definition.</p>
<p>Here’s how you can load an analysis without the original class definition:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the analysis state without the original class definition</span>
<span class="n">loaded_analysis</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;analysis.yax&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="selective-loading">
<h4>Selective Loading<a class="headerlink" href="#selective-loading" title="Link to this heading">#</a></h4>
<p>Sometimes analysis states can be very large and for downstream analyses or visualizations you may only need a subset of the results.
This is also useful when you only want to see what an analysis structure looks like without running it or needing to load the entire state.</p>
<p><code class="docutils literal notranslate"><span class="pre">yaflux</span></code> provides 4 ways to laod analysis states with selective loading:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the full analysis</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;analysis.yax&quot;</span><span class="p">)</span>

<span class="c1"># Load the analysis without any results</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;analysis.yax&quot;</span><span class="p">,</span> <span class="n">no_results</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Load the analysis with a selected subset of the results</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;analysis.yax&quot;</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span> <span class="s2">&quot;processed_data&quot;</span><span class="p">])</span>

<span class="c1"># Load the analysis but exclude a subset of the results</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;analysis.yax&quot;</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="s2">&quot;final_data&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="visualizing-analysis-steps">
<h2>Visualizing Analysis Steps<a class="headerlink" href="#visualizing-analysis-steps" title="Link to this heading">#</a></h2>
<p>A useful feature of <code class="docutils literal notranslate"><span class="pre">yaflux</span></code> is the ability to visualize the analysis steps.</p>
<p>You can generate a graph of the analysis workflow using the <code class="docutils literal notranslate"><span class="pre">visualize_dependencies</span></code> method:</p>
<p>Let’s first define a complex analysis with multiple steps and dependencies:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaflux</span> <span class="k">as</span> <span class="nn">yf</span>

<span class="k">class</span> <span class="nc">MyAnalysis</span><span class="p">(</span><span class="n">yf</span><span class="o">.</span><span class="n">Base</span><span class="p">):</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;proc_x&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">process_x</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;proc_y1&quot;</span><span class="p">,</span> <span class="s2">&quot;proc_y2&quot;</span><span class="p">,</span> <span class="s2">&quot;_marked&quot;</span><span class="p">],</span> <span class="n">requires</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">process_y</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;proc_z&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;proc_y1&quot;</span><span class="p">,</span> <span class="s2">&quot;proc_y2&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">process_z</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">proc_y1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">proc_y2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">z</span>

    <span class="nd">@yf</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">creates</span><span class="o">=</span><span class="s2">&quot;final&quot;</span><span class="p">,</span> <span class="n">requires</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;proc_x&quot;</span><span class="p">,</span> <span class="s2">&quot;proc_z&quot;</span><span class="p">,</span> <span class="s2">&quot;_marked&quot;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">final</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">proc_x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">proc_z</span>
</pre></div>
</div>
<p>You can then visualize the dependencies between the analysis steps:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span> <span class="o">=</span> <span class="n">MyAnalysis</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">visualize_dependencies</span><span class="p">()</span>
</pre></div>
</div>
<p>This will create a graph of the analysis steps and their dependencies, which can help you understand the workflow structure.
<img alt="Alt text" src="_images/complex_workflow_init.svg" /></p>
<p>As we run analysis steps this workflow will update to reflect the current state of the analysis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">process_x</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">process_y</span><span class="p">()</span>
<span class="n">analysis</span><span class="o">.</span><span class="n">visualize_dependencies</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="Alt text" src="_images/complex_workflow_progress.svg" /></p>
<p>This can be useful for understanding complex workflows and ensuring that all dependencies are correctly specified.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="installation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Installation</p>
      </div>
    </a>
    <a class="right-next"
       href="design.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Design Philosophy</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-an-analysis">Defining an Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-analysis">Example Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-decorator">Step Decorator</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies">Dependencies</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mutability">Mutability</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#flag-setting">Flag Setting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#executing-an-analysis">Executing an Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#runtime-inference">Runtime Inference</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#redundant-execution">Redundant Execution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependency-tracking">Dependency Tracking</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-and-loading-analysis-states">Saving and Loading Analysis States</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saving">Saving</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#loading">Loading</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-with-original-class-definition">Loading with Original Class Definition</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-without-original-class-definition">Loading without Original Class Definition</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selective-loading">Selective Loading</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-analysis-steps">Visualizing Analysis Steps</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/quick_start.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, noam teyssier.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>