import{T as u}from"./tabixIndexedFile-BzYBftJ8.js";import{a9 as c}from"./index-Bm2SqMk3.js";import{V as g,a as p}from"./index-D8cpZQYx.js";import{B as h}from"./index-6rN3ss-L.js";import{r as l}from"./rxjs-DT7GVwt0.js";class F extends h.BaseFeatureDataAdapter{async configurePre(){const e=this.pluginManager,t=this.getConf("vcfGzLocation"),a=this.getConf(["index","location"]),s=this.getConf(["index","indexType"]),o=c.openLocation(t,e),n=s==="CSI",r=new u({filehandle:o,csiFilehandle:n?c.openLocation(a,e):void 0,tbiFilehandle:n?void 0:c.openLocation(a,e),chunkCacheSize:50*2**20}),i=await r.getHeader();return{vcf:r,parser:new g({header:i})}}async configure(){return this.configured||(this.configured=this.configurePre().catch(e=>{throw this.configured=void 0,e})),this.configured}async getRefNames(e={}){const{vcf:t}=await this.configure();return t.getReferenceSequenceNames(e)}async getHeader(){const{vcf:e}=await this.configure();return e.getHeader()}async getMetadata(){const{parser:e}=await this.configure();return e.getMetadata()}getFeatures(e,t={}){return l.ObservableCreate(async a=>{const{refName:s,start:o,end:n}=e,{vcf:r,parser:i}=await this.configure();await r.getLines(s,o,n,{lineCallback:(f,d)=>{a.next(new p({variant:i.parseLine(f),parser:i,id:`${this.id}-vcf-${d}`}))},...t}),a.complete()},t.stopToken)}async getSources(){const{parser:e}=await this.configure();return e.samples.map(t=>({name:t}))}freeResources(){}}export{F as default};
