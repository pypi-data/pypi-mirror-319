const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DeletePluginDialog-BGfq7XEV.js","assets/index-Bm2SqMk3.js","assets/index-B32Lr0K5.css","assets/AddCustomPluginDialog-Dt00BL8_.js","assets/ExpandMore-D59AlJWk.js"])))=>i.map(i=>d[i]);
import{b3 as h,b4 as P,b5 as x,f as I,a as d,_ as T,m as C,o as _,u as m,b$ as y,R as e,as as B,ac as D,at as z,T as c,ab as W,ar as V,bJ as H,bK as J,L as Y,c0 as K,B as w,bk as U,c1 as G,d as Q,bm as X,c2 as k,c3 as S,c as Z}from"./index-Bm2SqMk3.js";import{C as ee}from"./Clear-DseTcK22.js";import{E as R}from"./ExpandMore-D59AlJWk.js";var g={},L;function te(){if(L)return g;L=1;var t=h();Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var n=t(P()),a=x();return g.default=(0,n.default)((0,a.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined"),g}var ne=te();const ae=I(ne);var f={},j;function re(){if(j)return f;j=1;var t=h();Object.defineProperty(f,"__esModule",{value:!0}),f.default=void 0;var n=t(P()),a=x();return f.default=(0,n.default)((0,a.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"}),"Lock"),f}var se=re();const le=I(se),oe=d.lazy(()=>T(()=>import("./DeletePluginDialog-BGfq7XEV.js"),__vite__mapDeps([0,1,2]))),ie=C()(()=>({lockedPluginTooltip:{marginRight:"0.5rem"}}));function ce(){const{classes:t}=ie();return e.createElement(W,{className:t.lockedPluginTooltip,title:"This plugin was installed by an administrator, you cannot remove it."},e.createElement(le,null))}const ue=_(function({plugin:t,model:n}){const{pluginManager:a}=m.getEnv(n),l=m.getSession(n),{jbrowse:s,adminMode:i}=l,o=y.isSessionWithSessionPlugins(l)?l.sessionPlugins.some(r=>{var u;return((u=a.pluginMetadata[t.name])===null||u===void 0?void 0:u.url)===r.url}):!1;return e.createElement(B,{key:t.name},i||o?e.createElement(D,{"data-testid":`removePlugin-${t.name}`,onClick:()=>{l.queueDialog(r=>[oe,{plugin:t.name,onClose:u=>{if(u){const E=a.pluginMetadata[t.name];i?s.removePlugin(E):y.isSessionWithSessionPlugins(l)&&l.removeSessionPlugin(E)}r()}}])}},e.createElement(z,null)):e.createElement(ce,null),e.createElement(c,null,t.name))}),me=_(function({pluginManager:n,model:a}){const{plugins:l}=n,{filterText:s}=a,i=l.filter(o=>{var r;return!(!((r=n.pluginMetadata[o.name])===null||r===void 0)&&r.isCore)});return e.createElement(V,null,i.length>0?i.filter(o=>o.name.toLowerCase().includes(s.toLowerCase())).map(o=>e.createElement(ue,{key:o.name,plugin:o,model:a})):e.createElement(c,null,"No plugins currently installed"))});var v={},q;function de(){if(q)return v;q=1;var t=h();Object.defineProperty(v,"__esModule",{value:!0}),v.default=void 0;var n=t(P()),a=x();return v.default=(0,n.default)((0,a.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),v}var ge=de();const fe=I(ge);var p={},M;function ve(){if(M)return p;M=1;var t=h();Object.defineProperty(p,"__esModule",{value:!0}),p.default=void 0;var n=t(P()),a=x();return p.default=(0,n.default)((0,a.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"}),"Person"),p}var pe=ve();const Ee=I(pe),he=C()({card:{margin:"0.5em"},icon:{marginLeft:"0.5em",marginRight:"0.5em"},bold:{fontWeight:600},dataField:{display:"flex",alignItems:"center"},mr:{marginRight:"0.5em"}}),Pe=_(function({plugin:n,model:a}){const{classes:l}=he(),s=m.getSession(a),{pluginManager:i}=m.getEnv(a),{runtimePluginDefinitions:o}=i,r=o.some(b=>"url"in b&&b.url===n.url),[u,E]=d.useState(!1),{adminMode:N,jbrowse:A}=s,{name:O,authors:F,description:$}=n;return e.createElement(H,{variant:"outlined",key:O,className:l.card},e.createElement(J,null,e.createElement(c,{variant:"h5"},e.createElement(Y,{href:`${n.location}#readme`,target:"_blank",rel:"noopener"},n.name)),e.createElement("div",{className:l.dataField},e.createElement(Ee,{className:l.mr}),e.createElement(c,null,F.join(", "))),e.createElement(c,{className:l.bold},"Description:"),e.createElement(c,null,$)),e.createElement(K,null,e.createElement(w,{variant:"contained",disabled:r||u,startIcon:r?e.createElement(fe,null):e.createElement(U,null),onClick:()=>{N?A.addPlugin(n):y.isSessionWithSessionPlugins(s)?s.addSessionPlugin(n):s.notify("No way to install plugin"),E(!0)}},r?"Installed":"Install")))});function xe(){const[t,n]=d.useState(),[a,l]=d.useState();return d.useEffect(()=>{(async()=>{try{const s=await fetch("https://jbrowse.org/plugin-store/plugins.json");if(!s.ok){const o=await s.text();throw new Error(`HTTP ${s.status} fetching plugins: ${o}`)}const i=await s.json();n(i.plugins)}catch(s){console.error(s),l(s)}})()},[]),{plugins:t,error:a}}const Ie=d.lazy(()=>T(()=>import("./AddCustomPluginDialog-Dt00BL8_.js"),__vite__mapDeps([3,1,2,4]))),_e=C()(t=>({expandIcon:{color:t.palette.tertiary.contrastText},adminBadge:{borderRadius:3,backgroundColor:t.palette.quaternary.main,padding:"1em",display:"flex",alignContent:"center"},customPluginButton:{margin:"1em auto",display:"flex"},mr:{marginRight:"0.3em"},m:{margin:"1em"}})),ke=_(function({model:t}){const{classes:n}=_e(),{plugins:a,error:l}=xe(),s=m.getSession(t),{adminMode:i}=s,{pluginManager:o}=G(t);return e.createElement("div",null,i&&e.createElement(e.Fragment,null,!m.isElectron&&e.createElement("div",{className:n.adminBadge},e.createElement(ae,{className:n.mr}),e.createElement(c,null,"You are using the ",e.createElement("code",null,"admin-server"),". Any changes you make will be saved to your configuration file. You also have the ability to add custom plugins that are not in the store.")),e.createElement(w,{className:n.customPluginButton,variant:"contained",onClick:()=>{s.queueDialog(r=>[Ie,{model:t,onClose:r}])}},"Add custom plugin")),e.createElement(Q,{label:"Filter plugins",value:t.filterText,onChange:r=>{t.setFilterText(r.target.value)},fullWidth:!0,slotProps:{input:{endAdornment:e.createElement(X,{position:"end"},e.createElement(D,{onClick:()=>{t.clearFilterText()}},e.createElement(ee,null)))}}}),e.createElement(k,{defaultExpanded:!0},e.createElement(S,{expandIcon:e.createElement(R,{className:n.expandIcon})},e.createElement(c,{variant:"h5"},"Installed plugins")),e.createElement("div",{className:n.m},e.createElement(me,{pluginManager:o,model:t}))),e.createElement(k,{defaultExpanded:!0},e.createElement(S,{expandIcon:e.createElement(R,{className:n.expandIcon})},e.createElement(c,{variant:"h5"},"Available plugins")),l?e.createElement(c,{color:"error"},`${l}`):a?a.filter(r=>!(m.isElectron&&r.cjsUrl)&&r.name.toLowerCase().includes(t.filterText.toLowerCase())).map(r=>e.createElement(Pe,{key:r.name,plugin:r,model:t})):e.createElement(Z.LoadingEllipses,null)))});export{ke as default};
