const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BreakendSingleLevelOptionDialog-BmZ-GTMg.js","assets/index-Bm2SqMk3.js","assets/index-B32Lr0K5.css"])))=>i.map(i=>d[i]);
import{u,b7 as b,t as k,b8 as $,a as y,R as a,T as v,c as A,_ as w,L as E,b9 as R}from"./index-Bm2SqMk3.js";import{B}from"./BaseCard-BEWjgl8a.js";import{n as C}from"./AlignmentsFeatureDetail-sMQ4gXe4.js";import"./FeatureDetails-BOlRKFD_.js";async function D({view:e,feature:n}){var s;const{assemblyManager:o}=u.getSession(e),r=n.get("CIGAR"),i=n.get("strand"),g=((s=n.get("tags"))===null||s===void 0?void 0:s.SA)||"",p=n.get("name"),t=b(r,1),f=await o.waitForAssembly(e.assemblyNames[0]);if(!f)throw new Error("assembly not found");const c=k(g,n.id(),i,p,!0),l=n.toJSON();l.clipPos=t,l.strand=1,l.mate={refName:p,start:t,end:t+$(r)};const S=[l,...c];return S.forEach((m,d)=>{m.refName=f.getCanonicalRefName(m.refName)||m.refName,m.syntenyId=d,m.mate.syntenyId=d,m.mate.uniqueId=`${m.uniqueId}_mate`}),S.sort((m,d)=>m.clipPos-d.clipPos),S}const P=y.lazy(()=>w(()=>import("./BreakendSingleLevelOptionDialog-BmZ-GTMg.js").then(e=>e.B),__vite__mapDeps([0,1,2]))),V=y.lazy(()=>w(()=>import("./BreakendSingleLevelOptionDialog-BmZ-GTMg.js").then(e=>e.a),__vite__mapDeps([0,1,2])));function I({model:e,feature:n}){const{view:s}=e,[o,r]=y.useState(),[i,g]=y.useState();y.useEffect(()=>{(async()=>{try{const t=await D({view:s,feature:new u.SimpleFeature(n)});r(t)}catch(t){g(t),console.error(t)}})()},[n,s]);const p=[];if(o)for(let t=0;t<o.length-1;t++)p.push([o[t],o[t+1]]);return p.length?a.createElement("div",null,a.createElement(v,null,"Launch split view"),i?a.createElement(A.ErrorMessage,{error:i}):null,a.createElement("ul",null,p.map((t,f)=>{const[c,l]=t;return a.createElement("li",{key:`${JSON.stringify(t)}-${f}`},c.refName,":",u.toLocale(c.strand===1?c.end:c.start)," ->"," ",l.refName,":",u.toLocale(l.strand===1?l.start:l.end)," ",a.createElement(O,{model:e,f1:c,f2:l})," ",a.createElement(T,{model:e,f1:c,f2:l}))}))):null}function O({model:e,f1:n,f2:s}){return a.createElement(E,{href:"#",onClick:o=>{o.preventDefault();const r=u.getSession(e);r.queueDialog(i=>[P,{handleClose:i,session:r,feature:new u.SimpleFeature({...n,mate:s}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])}},"(top/bottom)")}function T({model:e,f1:n,f2:s}){return a.createElement(E,{href:"#",onClick:o=>{o.preventDefault();const r=u.getSession(e);r.queueDialog(i=>[V,{handleClose:i,session:r,feature:new u.SimpleFeature({...n,mate:s}),view:e.view,assemblyName:e.view.displayedRegions[0].assemblyName}])}},"(single row)")}function M({tag:e,model:n}){return a.createElement("div",null,a.createElement(v,null,"List of supplementary alignment locations"),a.createElement("ul",null,e.split(";").filter(s=>!!s).map((s,o)=>{const[r,i,g,p]=s.split(","),t=R(p),f=Math.floor(t/5),c=+i,l=+i+t,S=c-f,m=l+f,d=`${r}:${Math.max(1,S)}-${m}`,h=c.toLocaleString("en-US"),L=l.toLocaleString("en-US"),N=`${r}:${h}-${L} (${g}) [${t}bp]`;return a.createElement("li",{key:`${d}-${o}`},a.createElement(E,{href:"#",onClick:async _=>{_.preventDefault(),C(d,n)}},N))})))}function J(e){const{model:n,tag:s,feature:o}=e,r=u.getSession(n),{pluginManager:i}=u.getEnv(r);let g=!1;try{g=!!i.getViewType("BreakpointSplitView")}catch{}return a.createElement(B,{...e,title:"Supplementary alignments"},a.createElement(M,{model:n,tag:s}),g?a.createElement(I,{model:n,feature:o}):null)}export{J as default};
