import{m as p,o as I,R as e,ag as N,a_ as P,a$ as R,ai as A,ao as H,ak as L,r as E,P as T,a as m,b0 as _,b1 as B,b2 as K,b3 as U,b4 as W,u as g,b as G,E as $,K as O}from"./rpcWorker-CVTx5FIM.js";import{D as Y}from"./cjs-Is-kCwAU.js";import{C as j,a as z}from"./ColorPicker-CsOTGrvA.js";import{m as v,a as k}from"./util-BJs5r2KQ.js";const F=p()(t=>({closeButton:{position:"absolute",right:t.spacing(1),top:t.spacing(1),color:t.palette.grey[500]}}));function q(t){const l=E.useRef(null);return e.createElement(Y,{nodeRef:l,cancel:'[class*="MuiDialogContent-root"]',onStart:a=>{var c,r;return(r=(c=a.target)===null||c===void 0?void 0:c.className)===null||r===void 0?void 0:r.includes("MuiDialogTitle")}},e.createElement(T,{ref:l,...t}))}const J=I(function(l){const{classes:a}=F(),{title:c,children:r,onClose:i}=l;return e.createElement(N,{...l,PaperComponent:q},e.createElement(P,null,e.createElement(R,{style:{cursor:"move"}},c,i?e.createElement(A,{className:a.closeButton,onClick:()=>{i()}},e.createElement(H,null)):null),e.createElement(L,null),r))}),Q=p()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function V({rows:t,onChange:l,showTips:a}){const{classes:c}=Q(),[r,i]=E.useState(null),[o,h]=E.useState([]),{name:Z,color:ee,baseUri:te,...y}=t[0],[D,w]=E.useState("blue"),[C,x]=E.useState({idx:0,field:null});return e.createElement("div",null,e.createElement(m,{disabled:!o.length,onClick:n=>{i(n.currentTarget)}},"Change color of selected items"),e.createElement(m,{onClick:()=>{l(v([...t],o))},disabled:!o.length},e.createElement(_,null),a?"Move selected items up":null),e.createElement(m,{onClick:()=>{l(k([...t],o))},disabled:!o.length},e.createElement(B,null),a?"Move selected items down":null),e.createElement(m,{onClick:()=>{l(v([...t],o,t.length))},disabled:!o.length},e.createElement(K,null),a?"Move selected items to top":null),e.createElement(m,{onClick:()=>{l(k([...t],o,t.length))},disabled:!o.length},e.createElement(U,null),a?"Move selected items to bottom":null),e.createElement(j.ColorPopover,{anchorEl:r,color:D,onChange:n=>{w(n),o.forEach(s=>{const d=t.find(u=>u.name===s);d&&(d.color=n)}),l([...t])},onClose:()=>{i(null)}}),e.createElement("div",{style:{height:400,width:"100%"}},e.createElement(W,{getRowId:n=>n.name,checkboxSelection:!0,disableRowSelectionOnClick:!0,onRowSelectionModelChange:n=>{h(n)},rows:t,rowHeight:25,columnHeaderHeight:33,columns:[{field:"color",headerName:"Color",renderCell:({value:n,id:s})=>e.createElement(z,{color:n||"blue",onChange:d=>{const u=t.find(b=>b.name===s);u&&(u.color=d),l([...t])}})},{field:"name",headerName:"Name",width:g.measureGridWidth(t.map(n=>n.name))},...Object.keys(y).map(n=>({field:n,renderCell:({value:s})=>e.createElement("div",{className:c.cell},e.createElement(G.SanitizedHTML,{html:g.getStr(s)})),width:g.measureGridWidth(t.map(s=>`${s[n]}`))}))],sortModel:[],onSortModelChange:n=>{const s=n[0],d=(C.idx+1)%2,u=s.field||C.field;x({idx:d,field:u}),l(u?[...t].sort((b,M)=>{const f=g.getStr(b[u]),S=g.getStr(M[u]);return d===1?f.localeCompare(S):S.localeCompare(f)}):t)}})))}const X=p()({content:{minWidth:800}});function re({model:t,handleClose:l}){const{classes:a}=X(),{sources:c}=t,[r,i]=E.useState(structuredClone(c||[])),[o,h]=g.useLocalStorage("multiwiggle-showTips",!1);return e.createElement(J,{open:!0,onClose:l,maxWidth:"xl",title:"Multi-wiggle color/arrangement editor"},e.createElement($,{className:a.content},e.createElement(m,{variant:"contained",style:{float:"right"},onClick:()=>{h(!o)}},o?"Hide tips":"Show tips"),e.createElement("br",null),o?e.createElement(e.Fragment,null,"Helpful tips",e.createElement("ul",null,e.createElement("li",null,"You can select rows in the table with the checkboxes"),e.createElement("li",null,"Multi-select is enabled with shift-click and control-click"),e.createElement("li",null,'The "Move selected items up/down" can re-arrange subtracks'),e.createElement("li",null,"Sorting the data grid itself can also re-arrange subtracks"),e.createElement("li",null,"Changes are applied when you hit Submit"),e.createElement("li",null,"You can click and drag the dialog box to move it on the screen"),e.createElement("li",null,"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"))):null,e.createElement(V,{rows:r,onChange:i,showTips:o})),e.createElement(O,null,e.createElement(m,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{t.clearLayout(),i(t.sources||[])}},"Clear custom settings"),e.createElement(m,{variant:"contained",color:"secondary",onClick:()=>{l(),i([...t.sources||[]])}},"Cancel"),e.createElement(m,{variant:"contained",color:"primary",type:"submit",onClick:()=>{t.setLayout(r),l()}},"Submit")))}export{re as default};
