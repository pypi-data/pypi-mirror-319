(()=>{"use strict";var t,e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r=function(){var t=document.currentScript;if(!t){for(var e=document.getElementsByTagName("script"),r=[],n=0;n<e.length;n++)r.push(e[n]);t=(r=r.filter((function(t){return!t.async&&!t.text&&!t.textContent}))).slice(-1)[0]}return t};if(Object.defineProperty(e,"p",{get:(t=r().src.split("/").slice(0,-1).join("/")+"/",function(){return t})}),"undefined"!=typeof jsonpScriptSrc){var n=jsonpScriptSrc;jsonpScriptSrc=function(t){var e,o=(e=r(),/\/_dash-component-suites\//.test(e.src)),i=n(t);if(!o)return i;var u=i.split("/"),a=u.slice(-1)[0].split(".");return a.splice(1,0,"v0_0_2m1736359262"),u.splice(-1,1,a.join(".")),u.join("/")}}var o={};e.r(o),e.d(o,{AttentionHighlight:()=>x,TextInput:()=>d,WordCloud:()=>B});const i=window.React;var u=e.n(i);const a=window.PropTypes;var c=e.n(a);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l(n.key),n)}}function l(t){var e=function(t){if("object"!=s(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:e+""}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}var d=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=h(e),function(t,e){if(e&&("object"==s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(e,r||[],h(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}(e,t),r=e,n=[{key:"render",value:function(){var t=this.props,e=t.id,r=t.label,n=t.setProps,o=t.value;return u().createElement("div",{id:e},r,u().createElement("input",{value:o,onChange:function(t){return n({value:t.target.value})}}))}}],n&&f(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(i.Component);function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,m(n.key),n)}}function m(t){var e=function(t){if("object"!=b(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==b(e)?e:e+""}function g(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(g=function(){return!!t})()}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}function O(t,e){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},O(t,e)}d.defaultProps={},d.propTypes={id:c().string,label:c().string.isRequired,value:c().string,setProps:c().func};var x=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=w(e),function(t,e){if(e&&("object"==b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,g()?Reflect.construct(e,r||[],w(t).constructor):e.apply(t,r))}(this,e,[t])).state={hoveredIndex:null},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O(t,e)}(e,t),r=e,(n=[{key:"validateProps",value:function(){var t=this.props,e=t.tokens,r=t.attentionMatrix;if(!r)return!0;if(r.length!==e.length)return console.error("AttentionMatrix rows must match tokens length"),!1;for(var n=0;n<r.length;n++){if(!r[n]||r[n].length!==e.length)return console.error("AttentionMatrix must be square"),!1;for(var o=0;o<r[n].length;o++)if("number"!=typeof r[n][o]||r[n][o]<0||r[n][o]>1)return console.error("AttentionMatrix values must be numbers between 0 and 1"),!1}return!0}},{key:"getHighlightColor",value:function(t,e,r){if(!this.validateProps())return"transparent";if(null===e)return"rgba(200, 200, 200, 0.1)";if(t===e)return"rgba(66, 135, 245, 0.3)";var n=.8*Math.pow(r,.5);return"rgba(255, 165, 0, ".concat(n,")")}},{key:"render",value:function(){var t=this,e=this.props,r=e.id,n=e.tokens,o=e.attentionMatrix,i=(e.setProps,this.state.hoveredIndex);return u().createElement("div",{id:r,style:{lineHeight:"2em",padding:"1em",fontFamily:"sans-serif"}},n.map((function(e,r){var n=null!==i&&o?o[i][r]:0;return u().createElement("span",{key:r,style:{padding:"0.4em 0.6em",margin:"0.2em",display:"inline-block",backgroundColor:t.getHighlightColor(r,i,n),transition:"all 0.3s ease",cursor:"pointer",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"4px",fontSize:"1em",boxShadow:i===r?"0 2px 4px rgba(0,0,0,0.1)":"none"},onMouseEnter:function(){return t.setState({hoveredIndex:r})},onMouseLeave:function(){return t.setState({hoveredIndex:null})}},e)})))}}])&&v(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(i.Component);function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function S(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){k(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function k(t,e,r){return(e=I(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M(t){return function(t){if(Array.isArray(t))return E(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||R(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=R(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){a=!0,i=t},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw i}}}}function R(t,e){if(t){if("string"==typeof t)return E(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(t,e):void 0}}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,I(n.key),n)}}function D(t,e,r){return e&&C(t.prototype,e),r&&C(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function I(t){var e=function(t){if("object"!=j(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==j(e)?e:e+""}function A(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(A=function(){return!!t})()}function z(t){return z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},z(t)}function q(t,e){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},q(t,e)}x.defaultProps={tokens:[],attentionMatrix:null},x.propTypes={id:c().string,tokens:c().arrayOf(c().string),attentionMatrix:c().arrayOf(c().arrayOf(c().number)),setProps:c().func};var B=function(t){function e(t){var r,n,o,i;return T(this,e),(n=this,o=e,i=[t],o=z(o),r=function(t,e){if(e&&("object"==j(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(n,A()?Reflect.construct(o,i||[],z(n).constructor):o.apply(n,i))).containerRef=u().createRef(),r.state={wordPositions:new Map,containerDimensions:{width:500,height:500}},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&q(t,e)}(e,t),D(e,[{key:"componentDidMount",value:function(){this.setupResizeObserver(),this.updateContainerDimensions()}},{key:"componentDidUpdate",value:function(t){t.words===this.props.words&&t.style===this.props.style||this.updateContainerDimensions()}},{key:"componentWillUnmount",value:function(){this.resizeObserver&&this.resizeObserver.disconnect()}},{key:"setupResizeObserver",value:function(){var t=this;this.resizeObserver=new ResizeObserver((function(e){var r,n=_(e);try{for(n.s();!(r=n.n()).done;){var o=r.value.contentRect,i=o.width,u=o.height;i===t.state.containerDimensions.width&&u===t.state.containerDimensions.height||t.setState({containerDimensions:{width:i,height:u}},(function(){t.calculateWordPositions()}))}}catch(t){n.e(t)}finally{n.f()}})),this.containerRef.current&&this.resizeObserver.observe(this.containerRef.current)}},{key:"updateContainerDimensions",value:function(){var t=this;if(this.containerRef.current){var e=this.containerRef.current.getBoundingClientRect(),r=e.width,n=e.height;this.setState({containerDimensions:{width:r,height:n}},(function(){t.calculateWordPositions()}))}}},{key:"seededRandom",value:function(t){var e=1e4*Math.sin(t++);return e-Math.floor(e)}},{key:"getFontSize",value:function(t,e){var r=Math.max.apply(Math,M(e.map((function(t){return t.weight})))),n=Math.min.apply(Math,M(e.map((function(t){return t.weight}))));return 12+(t-n)/(r-n)*16}},{key:"createQuadTree",value:function(t){var e=function(){function t(e){T(this,t),this.bounds=e,this.points=[],this.children=null,this.maxPoints=4}return D(t,[{key:"insert",value:function(t){if(!this.contains(t))return!1;if(!this.children){if(this.points.length<this.maxPoints)return this.points.push(t),!0;this.subdivide()}if(this.children){var e,r=_(this.children);try{for(r.s();!(e=r.n()).done;)if(e.value.insert(t))return!0}catch(t){r.e(t)}finally{r.f()}}return!1}},{key:"subdivide",value:function(){var e=this.bounds,r=e.x,n=e.y,o=e.width/2,i=e.height/2;this.children=[{x:r,y:n,width:o,height:i},{x:r+o,y:n,width:o,height:i},{x:r,y:n+i,width:o,height:i},{x:r+o,y:n+i,width:o,height:i}].map((function(e){return new t(e)}));var u,a=_(this.points);try{for(a.s();!(u=a.n()).done;){var c,s=u.value,f=_(this.children);try{for(f.s();!(c=f.n()).done&&!c.value.insert(s););}catch(t){f.e(t)}finally{f.f()}}}catch(t){a.e(t)}finally{a.f()}this.points=[]}},{key:"contains",value:function(t){var e=this.bounds,r=e.x,n=e.y,o=e.width,i=e.height;return t.x>=r&&t.x<r+o&&t.y>=n&&t.y<n+i}},{key:"query",value:function(t){var e=[];if(!this.intersects(t))return e;if(this.children){var r,n=_(this.children);try{for(n.s();!(r=n.n()).done;){var o=r.value;e.push.apply(e,M(o.query(t)))}}catch(t){n.e(t)}finally{n.f()}}else{var i,u=_(this.points);try{for(u.s();!(i=u.n()).done;){var a=i.value;this.pointInRange(a,t)&&e.push(a)}}catch(t){u.e(t)}finally{u.f()}}return e}},{key:"intersects",value:function(t){var e=this.bounds,r=e.x,n=e.y,o=e.width,i=e.height;return!(t.x>r+o||t.x+t.width<r||t.y>n+i||t.y+t.height<n)}},{key:"pointInRange",value:function(t,e){return t.x>=e.x&&t.x<e.x+e.width&&t.y>=e.y&&t.y<e.y+e.height}}])}();return new e(t)}},{key:"calculateWordPositions",value:function(){var t=this,e=this.props.words,r=this.state.containerDimensions,n=r.width,o=r.height,i=n/2,u=o/2,a=new Map,c=this.createQuadTree({x:0,y:0,width:n,height:o}),s=.5*Math.min(n,o);M(e).sort((function(t,e){return e.weight-t.weight})).forEach((function(r,f){var l=t.getFontSize(r.weight,e),p=r.text.split("").reduce((function(t,e){return t+e.charCodeAt(0)}),100*f),h=function(e,r,a){for(var f,l=Math.ceil(e.length*r*.6),p=Math.ceil(1.2*r),h=l+8,y=p+8,d=null,b=1/0,v=(1+Math.sqrt(5))/2,m=2*t.seededRandom(a)*Math.PI,g=0,w=.02*Math.min(n,o),O=function(){g+=w,m+=2*Math.PI/v;var t=i+g*Math.cos(m),e=u+g*Math.sin(m);if(t<h/2+4||t>n-h/2-4||e<y/2+4||e>o-y/2-4)return 0;var r=0,a=0,f=225;c.query({x:t-f,y:e-f,width:450,height:450}).forEach((function(n){var o=t-n.x,i=e-n.y,u=Math.sqrt(o*o+i*i);if(u>0&&u<f){var c=150*Math.pow(1-u/f,1.5),l=u<s?1.2:1;r+=o/u*c*l,a+=i/u*c*l}}));var l=t+r,p=e+a;if(l<h/2+4||l>n-h/2-4||p<y/2+4||p>o-y/2-4)return 0;var O=c.query({x:l-h/2,y:p-y/2,width:h,height:y}).length;return O<b&&(d={left:l,top:p,width:h,height:y},0===(b=O))?1:void 0},x=0;x<100&&(0===(f=O())||1!==f);x++);return d&&c.insert({x:d.left,y:d.top,width:d.width,height:d.height}),d||{left:i,top:u,width:h,height:y}}(r.text,l,p);a.set(r.text,S(S({},h),{},{fontSize:l}))})),this.setState({wordPositions:a})}},{key:"render",value:function(){var t=this.props,e=t.id,r=t.words,n=t.setProps,o=t.style,i=this.state,a=i.containerDimensions,c=i.wordPositions,s=a.width,f=a.height,l=M(r).sort((function(t,e){return e.weight-t.weight}));return u().createElement("div",{id:e,ref:this.containerRef,style:S({position:"relative",width:"".concat(s,"px"),height:"".concat(f,"px"),border:"1px solid #ddd",borderRadius:"4px",overflow:"hidden"},o)},l.map((function(t,e){var r=c.get(t.text);if(!r)return null;var o=r.left,i=r.top,a=r.width,s=r.height,f=r.fontSize;return u().createElement("div",{key:t.text,style:{position:"absolute",left:"".concat(o,"px"),top:"".concat(i,"px"),width:"".concat(a,"px"),height:"".concat(s,"px"),transform:"translate(-50%, -50%)",whiteSpace:"nowrap",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"".concat(f,"px"),color:"hsl(".concat(37*e%360,", 70%, 50%)"),cursor:"pointer",userSelect:"none",backgroundColor:"rgba(255, 255, 255, 0.95)",borderRadius:"4px",boxShadow:"0 1px 2px rgba(0,0,0,0.1)",transition:"transform 0.3s ease-in-out, opacity 0.3s ease-in-out",opacity:r?1:0},onClick:function(){n&&n({clickedWord:t.text})}},t.text)})))}}])}(i.Component);B.defaultProps={words:[]},B.propTypes={id:c().string,words:c().arrayOf(c().shape({text:c().string.isRequired,weight:c().number.isRequired})),clickedWord:c().string,setProps:c().func,style:c().object},window.dash_text_components=o})();
//# sourceMappingURL=dash_text_components.min.js.map