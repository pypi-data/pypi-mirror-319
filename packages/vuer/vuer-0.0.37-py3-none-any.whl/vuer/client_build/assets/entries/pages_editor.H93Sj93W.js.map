{"version":3,"file":"pages_editor.H93Sj93W.js","sources":["../../../../pages/editor/+Page.tsx"],"sourcesContent":["import React, { useEffect, useMemo } from 'react';\nimport { Helmet } from '@vuer-ai/react-helmet-async';\nimport './index.scss';\nimport {\n  AmbientLight,\n  Grid,\n  Hands,\n  PlaybackBar,\n  PlaybackProvider,\n  PointLight,\n  ResizableSwitch,\n  WebSocketProvider,\n  Timeline,\n  SceneContainer,\n  useSocket,\n  Combine,\n  PlaybackStateProvider,\n  usePlayback,\n  TimelineStateProvider,\n  Resizable,\n  GraphView,\n  useSceneStore,\n  TimelineFileDrop,\n  SceneFileDropContainer\n} from '@vuer-ai/vuer';\nimport { Leva } from 'leva';\n\nfunction VuerPlayback() {\n  const playback = usePlayback();\n  const { downlink } = useSocket();\n\n  useEffect(() => {\n    if (!playback) return;\n    const cancel = [\n      downlink.subscribe('SET', playback.addKeyFrame),\n      downlink.subscribe('ADD', playback.addKeyFrame),\n      downlink.subscribe('UPDATE', playback.addKeyFrame),\n      downlink.subscribe('UPSERT', playback.addKeyFrame),\n      downlink.subscribe('REMOVE', playback.addKeyFrame),\n    ];\n\n    return () => {\n      cancel.forEach((f) => f());\n    };\n  }, [playback, downlink]);\n\n\n  const combinedStream = useMemo(\n    () => {\n      if (!playback?.store) return downlink;\n      return new Combine(downlink, playback.store);\n    },\n    [downlink, playback?.store],\n  );\n\n\n  if (!playback) {\n    return (\n      <SceneFileDropContainer stream={combinedStream}>\n        <SceneContainer\n          frameloop=\"always\"\n          stream={downlink}\n          bgChildren={[\n            <Grid key=\"default-grid\" _key=\"default-grid\" />,\n            <AmbientLight key=\"ambient\" intensity={0.25} />,\n            <PointLight key=\"spot\" intensity={1} position={[0, 1, 1]} />,\n            <Hands fps={30} eventType={['squeeze']} stream />,\n          ]}\n        />\n      </SceneFileDropContainer>\n    );\n  } else return (\n    <ResizableSwitch\n      offset={200}\n      minOffset={48}\n      hidden={true}\n      style={{\n        width: '100%',\n        height: '100%',\n      }}\n    >\n      <SceneFileDropContainer\n        stream={combinedStream}\n        prompt={'scene files supported: *.urdf *.pcd *.ply *.splat'}\n      >\n        <SceneContainer\n          frameloop=\"always\"\n          stream={combinedStream}\n          bgChildren={[\n            <Grid key=\"default-grid\" _key=\"default-grid\" />,\n            <AmbientLight key=\"ambient\" intensity={0.25} />,\n            <PointLight key=\"spot\" intensity={1} position={[0, 1, 1]} />,\n            <Hands fps={30} eventType={['squeeze']} stream />,\n          ]}\n        />\n      </SceneFileDropContainer>\n      <>\n        <PlaybackStateProvider>\n          <TimelineStateProvider>\n            <PlaybackBar />\n            <TimelineFileDrop>\n              <Timeline />\n              {/*{clips.map((clip, i)=>{*/}\n              {/*  return <Clip {...clip} onDrag onSelectStart onSelectEnd/>*/}\n              {/*})}*/}\n            </TimelineFileDrop>\n          </TimelineStateProvider>\n        </PlaybackStateProvider>\n      </>\n      <PlaybackStateProvider>\n        <TimelineStateProvider>\n          <PlaybackBar />\n        </TimelineStateProvider>\n      </PlaybackStateProvider>\n    </ResizableSwitch>\n  );\n}\n\nfunction SidePanelView() {\n  // this is excessive. triggers when position/rotation changes too.\n  // const scene = useSceneStore(({ children, bgChildren, rawChildren }) =>\n  //   ({ children, bgChildren, rawChildren }));\n  const children = useSceneStore(({ children }) => children);\n  const sceneOps = useSceneStore(({ ops }) => ops);\n  // return <VuerPlayback />;\n\n  return (\n    <Resizable vertical offset={-200} hidden={true}>\n      <VuerPlayback />\n      <GraphView\n        title=\"Scene Graph\"\n        nodes={children}\n        sceneOps={sceneOps}\n      />\n    </Resizable>\n  );\n}\n\nexport default function Page() {\n  const isSSR = typeof window === 'undefined';\n\n  return (\n    <>\n      <Helmet>\n        <title>Vuer Editor</title>\n      </Helmet>\n      <main>\n        <PlaybackProvider>\n          {\n            isSSR ? null : (\n              <WebSocketProvider>\n                {/*<VuerPlayback />*/}\n                <SidePanelView />\n              </WebSocketProvider>\n            )\n          }\n        </PlaybackProvider>\n        <Leva\n          theme={{\n            sizes: {\n              rootWidth: '380px',\n              controlWidth: '200px',\n              numberInputMinWidth: '56px',\n            },\n          }}\n        />\n      </main>\n    </>\n  );\n}"],"names":["VuerPlayback","playback","usePlayback","downlink","useSocket","useEffect","cancel","f","combinedStream","useMemo","Combine","jsxs","ResizableSwitch","jsx","SceneFileDropContainer","SceneContainer","Grid","AmbientLight","PointLight","Hands","Fragment","PlaybackStateProvider","TimelineStateProvider","PlaybackBar","TimelineFileDrop","Timeline","SidePanelView","children","useSceneStore","sceneOps","ops","Resizable","GraphView","Page","isSSR","Helmet","PlaybackProvider","WebSocketProvider","Leva"],"mappings":"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"}