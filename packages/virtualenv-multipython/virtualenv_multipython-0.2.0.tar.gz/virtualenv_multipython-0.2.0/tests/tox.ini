[tox]
env_list = {env:ENVS_PASSING},{env:ENVS_FAILING}
skip_missing_interpreters = false
labels =
    passing = {env:ENVS_PASSING}
    failing = {env:ENVS_FAILING}

[testenv:passing]
allowlist_externals = bash
command =
    bash -c '[ "$(py tag {env_python})" = "{env_name}" ]'
    bash -c '[ "$(python -VV)" = "$({env_python} -VV)" ]'

# failing environments should not even be created
[testenv:failing]
allowlist_externals = bash
command = bash -c 'echo unreachable >&2'
