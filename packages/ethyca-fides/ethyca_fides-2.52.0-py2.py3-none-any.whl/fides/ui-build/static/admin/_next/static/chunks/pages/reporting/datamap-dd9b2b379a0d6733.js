(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9196],{86548:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reporting/datamap",function(){return s(83253)}])},81836:function(e,t,s){"use strict";var a=s(24246),i=s(27378),r=s(69746),n=s(79894),o=s.n(n);t.Z=e=>{let{breadcrumbs:t,fontSize:s="2xl",fontWeight:n="semibold",separator:l="->",lastItemStyles:c={color:"black"},normalItemStyles:d={color:"gray.500"},...u}=e;return(0,a.jsx)(r.aGc,{separator:l,fontSize:s,fontWeight:n,"data-testid":"breadcrumbs",...u,children:t.map((e,s)=>{let n=s+1===t.length;return e.title?(0,i.createElement)(r.gN6,{...d,...n?c:{},key:e.title,children:[(null==e?void 0:e.icon)&&(0,a.jsx)(r.xuv,{mr:2,children:e.icon}),e.link?(0,a.jsx)(r.Atw,{as:o(),href:e.link,isCurrentPage:n,children:e.title}):(0,a.jsx)(r.Atw,{_hover:{textDecoration:"none",cursor:"default"},isCurrentPage:n,children:e.title})]}):null})})}},72809:function(e,t,s){"use strict";var a=s(24246),i=s(69746),r=s(27378);let n=e=>{let t=e.split("."),s=[];return t.forEach(e=>{let t=s.length>0?s[s.length-1]:null;t?s.push("".concat(t,".").concat(e)):s.push(e)}),s},o=(e,t)=>{let s=n(t).filter(e=>e!==t);return e.filter(e=>s.includes(e)).length>0},l=(e,t)=>!!(e===t||e.startsWith("".concat(t,"."))),c=(e,t,s)=>{let a=null!=s?s:[];return e.forEach(e=>{e.children&&c(e.children,t,a),l(e.value,t)&&a.push(e)}),a},d=e=>{let{node:t,isChecked:s,onChecked:r,isExpanded:n,onExpanded:o,isIndeterminate:l,isDisabled:c,children:d}=e,{value:u,label:_}=t,p=!!t.children&&t.children.length>0;return(0,a.jsxs)(i.xuv,{children:[(0,a.jsxs)(i.xuv,{display:"flex",justifyContent:"space-between",_hover:{backgroundColor:"gray.100",cursor:"pointer"},onClick:()=>o(t),minHeight:8,children:[(0,a.jsx)(i.XZJ,{colorScheme:"complimentary",value:u,isChecked:!l&&s,isIndeterminate:l,isDisabled:c,onChange:()=>r(t),mx:2,"data-testid":"checkbox-".concat(_),children:_}),p?(0,a.jsx)(i.wpx,{"data-testid":"expand-".concat(_),"aria-label":n?"collapse":"expand",icon:(0,a.jsx)(i.v4q,{boxSize:5}),type:"text",onClick:()=>o(t),className:n?"rotate-180":void 0}):null]}),d&&(0,a.jsx)(i.xuv,{ml:5,children:d})]})};t.ZP=e=>{let{nodes:t,selected:s,onSelected:u,..._}=e,[p,m]=(0,r.useState)([]),[S,g]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=Array.from(new Set([...s.map(e=>n(e)).reduce((e,t)=>e.concat(t),[]),...s.map(e=>c(t,e)).reduce((e,t)=>e.concat(t),[]).map(e=>e.value)]));g(e),m(e)},[s,t]);let E=e=>{let a=[],i=[];p.indexOf(e.value)>=0?(a=p.filter(t=>!l(t,e.value)),i=s.filter(t=>!l(t,e.value))):(a=[...p,...c(t,e.value).map(e=>e.value)],i=[...s,e.value]),m(a),u(i)},h=e=>{S.indexOf(e.value)>=0?g(S.filter(t=>!l(t,e.value))):g([...S,e.value])},x=e=>{if(e.children){let i=p.indexOf(e.value)>=0,n=S.indexOf(e.value)>=0,l=c(t,e.value),u=i&&e.children.length>0&&p.filter(t=>t.startsWith("".concat(e.value,"."))).length+1!==l.length,_=o(s,e.value);return(0,a.jsx)(d,{node:e,isChecked:i,onChecked:E,isExpanded:n,onExpanded:h,isDisabled:_,isIndeterminate:u,children:n?e.children.map(e=>(0,a.jsx)(r.Fragment,{children:x(e)},e.value)):void 0})}return null};return(0,a.jsx)(i.xuv,{..._,children:t.map(e=>(0,a.jsx)(i.xuv,{children:x(e)},e.value))})}},65464:function(e,t,s){"use strict";var a=s(24246),i=s(69746),r=s(88038),n=s.n(r);s(27378),t.Z=e=>{let{children:t,title:s,mainProps:r}=e;return(0,a.jsxs)(i.kCb,{"data-testid":s,direction:"column",height:"calc(100vh - 48px)",width:"calc(100vw - 200px)",children:[(0,a.jsxs)(n(),{children:[(0,a.jsxs)("title",{children:["Fides Admin UI - ",s]}),(0,a.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,a.jsx)(i.kCb,{pt:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...r,children:t})]})}},79711:function(e,t,s){"use strict";s.d(t,{q:function(){return i}});var a=s(24246);let i=(0,s(69746).IUT)({displayName:"TrashCanOutlineIcon",viewBox:"0 0 11 12",path:(0,a.jsx)("path",{d:"M4.5166 1.60859L4.1084 2.21875H7.22363L6.81543 1.60859C6.7832 1.56133 6.72949 1.53125 6.67148 1.53125H4.6584C4.60039 1.53125 4.54668 1.55918 4.51445 1.60859H4.5166ZM7.6748 1.03711L8.46328 2.21875H8.75977H9.79102H9.96289C10.2486 2.21875 10.4785 2.44863 10.4785 2.73438C10.4785 3.02012 10.2486 3.25 9.96289 3.25H9.79102V9.78125C9.79102 10.7309 9.02188 11.5 8.07227 11.5H3.25977C2.31016 11.5 1.54102 10.7309 1.54102 9.78125V3.25H1.36914C1.0834 3.25 0.853516 3.02012 0.853516 2.73438C0.853516 2.44863 1.0834 2.21875 1.36914 2.21875H1.54102H2.57227H2.86875L3.65723 1.03496C3.88066 0.701953 4.25664 0.5 4.6584 0.5H6.67148C7.07324 0.5 7.44922 0.701953 7.67266 1.03496L7.6748 1.03711ZM2.57227 3.25V9.78125C2.57227 10.1615 2.87949 10.4688 3.25977 10.4688H8.07227C8.45254 10.4688 8.75977 10.1615 8.75977 9.78125V3.25H2.57227ZM4.29102 4.625V9.09375C4.29102 9.28281 4.13633 9.4375 3.94727 9.4375C3.7582 9.4375 3.60352 9.28281 3.60352 9.09375V4.625C3.60352 4.43594 3.7582 4.28125 3.94727 4.28125C4.13633 4.28125 4.29102 4.43594 4.29102 4.625ZM6.00977 4.625V9.09375C6.00977 9.28281 5.85508 9.4375 5.66602 9.4375C5.47695 9.4375 5.32227 9.28281 5.32227 9.09375V4.625C5.32227 4.43594 5.47695 4.28125 5.66602 4.28125C5.85508 4.28125 6.00977 4.43594 6.00977 4.625ZM7.72852 4.625V9.09375C7.72852 9.28281 7.57383 9.4375 7.38477 9.4375C7.1957 9.4375 7.04102 9.28281 7.04102 9.09375V4.625C7.04102 4.43594 7.1957 4.28125 7.38477 4.28125C7.57383 4.28125 7.72852 4.43594 7.72852 4.625Z",fill:"currentColor"})})},37541:function(e,t,s){"use strict";var a=s(24246),i=s(69746),r=s(19785),n=s.n(r),o=s(27378),l=s(81836);t.Z=e=>{let{breadcrumbs:t,isSticky:s=!0,children:r,rightContent:c,...d}=e;return(0,a.jsxs)(i.xuv,{bgColor:"white",paddingY:5,...s?{position:"sticky",top:0,left:0,zIndex:10}:{},...d,children:[(0,a.jsxs)(i.kCb,{alignItems:"flex-start",children:[(0,a.jsxs)(i.xuv,{flex:1,children:[n()(t)&&(0,a.jsx)(i.xuv,{marginBottom:r?4:0,children:(0,a.jsx)(l.Z,{breadcrumbs:t})}),(0,o.isValidElement)(t)&&t]}),c&&(0,a.jsx)(i.xuv,{children:c})]}),r]})}},38615:function(e,t,s){"use strict";s.d(t,{Tg:function(){return n}});var a=s(24246),i=s(44296),r=s(96451);let n=e=>(0,i.C)(r.uu).filter(t=>e.includes(t)).length>0;t.ZP=e=>{let{scopes:t,children:s}=e;return n(t)?(0,a.jsx)(a.Fragment,{children:s}):null}},91591:function(e,t,s){"use strict";s.d(t,{d:function(){return i}});var a=s(24246);let i=(0,s(69746).IUT)({displayName:"AddIcon",viewBox:"0 0 10 10",path:(0,a.jsx)("path",{d:"M4.33331 4.33398V0.333984H5.66665V4.33398H9.66665V5.66732H5.66665V9.66732H4.33331V5.66732H0.333313V4.33398H4.33331Z",fill:"currentColor"})})},19310:function(e,t,s){"use strict";var a=s(24246),i=s(64925),r=s.n(i),n=s(27378),o=s(44296),l=s(91650),c=s(79851),d=s(47411);let u=()=>{let{isLoading:e}=(0,c.fd)(),t=(0,o.C)(c.U3),{isLoading:s}=(0,d.MO)(),a=(0,o.C)(d.qb),{isLoading:i}=(0,l.te)();return{dataUses:t,dataSubjects:(0,o.C)(l.ZL),dataCategories:a,isLoading:e||s||i}};t.Z=()=>{let{dataUses:e,dataCategories:t,dataSubjects:s,isLoading:i}=u(),o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.split(".").slice(0,t).join(".")},l=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=t(e);if(!a)return{};let i=t(o(e,s)),r=!!a.parent_key;return{name:a.name||void 0,primaryName:r&&(null==i?void 0:i.name)!==a.name&&(null==i?void 0:i.name)||void 0}},c=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{name:i,primaryName:r}=l(e,t,s);return i?r?(0,a.jsxs)(n.Fragment,{children:[(0,a.jsxs)("strong",{children:[r,":"]})," ",i]},e):(0,a.jsx)("strong",{children:i},e):e},d=t=>r()(e,{fides_key:t}),_=e=>r()(t,{fides_key:e}),p=e=>r()(s,{fides_key:e});return{getDataUses:()=>e,getDataUseByKey:d,getDataUseDisplayName:e=>c(e,d,1),getDataCategories:()=>t,getDataCategoryByKey:_,getDataCategoryDisplayName:e=>c(e,_,2),getDataCategoryDisplayNameProps:e=>l(e,_,2),getDataSubjects:()=>s,getDataSubjectByKey:p,getDataSubjectDisplayName:e=>{let t=p(e);return t?t.name:e},getPrimaryKey:o,isLoading:i}}},91311:function(e,t,s){"use strict";var a,i;s.d(t,{C:function(){return r},L:function(){return a}});let r="root";(i=a||(a={})).DATA_CATEGORIES="Data categories",i.DATA_USES="Data uses",i.DATA_SUBJECTS="Data subjects"},62091:function(e,t,s){"use strict";s.d(t,{Cd:function(){return r},Xl:function(){return n}});var a=s(10284),i=s(91311);let r=(e,t)=>{let s;if(null==t&&e.every(e=>void 0===e.parent_key))s=e;else{let a=null!=t?t:null;s=e.filter(e=>e.parent_key===a)}return s.map(t=>{var s,a;let i=t.fides_key;return{value:t.fides_key,label:""===t.name||null==t.name?t.fides_key:t.name,description:t.description,children:r(e,i),is_default:null!==(s=t.is_default)&&void 0!==s&&s,active:null!==(a=t.active)&&void 0!==a&&a}})},n=e=>{switch(e){case i.L.DATA_CATEGORIES:return a.P6.DATA_CATEGORY;case i.L.DATA_SUBJECTS:return a.P6.DATA_SUBJECT;case i.L.DATA_USES:return a.P6.DATA_USE;default:return}}},83253:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ex}});var a,i,r,n,o=s(24246),l=s(27378),c=s(65464),d=s(37541),u=s(56721),_=s(10284);(a=r||(r={})).COLUMN_EXPANSION_STATE="datamap-column-expansion-state",a.COLUMN_NAMES="datamap-column-names",a.COLUMN_ORDER="datamap-column-order",a.COLUMN_SIZING="datamap-column-sizing",a.COLUMN_VISIBILITY="datamap-column-visibility",a.CUSTOM_REPORT_ID="datamap-custom-report-id",a.FILTERS="datamap-filters",a.GROUP_BY="datamap-group-by",a.SORTING_STATE="datamap-sorting-state",a.WRAPPING_COLUMNS="datamap-wrapping-columns",(i=n||(n={})).SYSTEM_NAME="system_name",i.DATA_USE="data_uses",i.DATA_CATEGORY="data_categories",i.DATA_SUBJECT="data_subjects",i.LEGAL_NAME="legal_name",i.DPO="dpo",i.LEGAL_BASIS_FOR_PROCESSING="legal_basis_for_processing",i.ADMINISTRATING_DEPARTMENT="administrating_department",i.COOKIE_MAX_AGE_SECONDS="cookie_max_age_seconds",i.PRIVACY_POLICY="privacy_policy",i.LEGAL_ADDRESS="legal_address",i.COOKIE_REFRESH="cookie_refresh",i.DATA_SECURITY_PRACTICES="data_security_practices",i.DATA_SHARED_WITH_THIRD_PARTIES="DATA_SHARED_WITH_THIRD_PARTIES",i.DATA_STEWARDS="data_stewards",i.DECLARATION_NAME="declaration_name",i.DOES_INTERNATIONAL_TRANSFERS="does_international_transfers",i.DPA_LOCATION="dpa_location",i.DESTINATIONS="egress",i.EXEMPT_FROM_PRIVACY_REGULATIONS="exempt_from_privacy_regulations",i.FEATURES="features",i.FIDES_KEY="fides_key",i.FLEXIBLE_LEGAL_BASIS_FOR_PROCESSING="flexible_legal_basis_for_processing",i.IMPACT_ASSESSMENT_LOCATION="impact_assessment_location",i.SOURCES="ingress",i.JOINT_CONTROLLER_INFO="joint_controller_info",i.LEGAL_BASIS_FOR_PROFILING="legal_basis_for_profiling",i.LEGAL_BASIS_FOR_TRANSFERS="legal_basis_for_transfers",i.LEGITIMATE_INTEREST_DISCLOSURE_URL="legitimate_interest_disclosure_url",i.LINK_TO_PROCESSOR_CONTRACT="link_to_processor_contract",i.PROCESSES_PERSONAL_DATA="processes_personal_data",i.REASON_FOR_EXEMPTION="reason_for_exemption",i.REQUIRES_DATA_PROTECTION_ASSESSMENTS="requires_data_protection_assessments",i.RESPONSIBILITY="responsibility",i.RETENTION_PERIOD="retention_period",i.SHARED_CATEGORIES="shared_categories",i.SPECIAL_CATEGORY_LEGAL_BASIS="special_category_legal_basis",i.SYSTEM_DEPENDENCIES="system_dependencies",i.THIRD_COUNTRY_SAFEGUARDS="third_country_safeguards",i.THIRD_PARTIES="third_parties",i.COOKIES="cookies",i.USES_COOKIES="uses_cookies",i.USES_NON_COOKIE_ACCESS="uses_non_cookie_access",i.USES_PROFILING="uses_profiling",i.SYSTEM_UNDECLARED_DATA_CATEGORIES="system_undeclared_data_categories",i.DATA_USE_UNDECLARED_DATA_CATEGORIES="data_use_undeclared_data_categories";let p={system_name:"System",data_uses:"Data use",data_categories:"Data categories",data_subjects:"Data subject",legal_name:"Legal name",dpo:"Data privacy officer",legal_basis_for_processing:"Legal basis for processing",administrating_department:"Administrating department",cookie_max_age_seconds:"Cookie max age seconds",privacy_policy:"Privacy policy",legal_address:"Legal address",cookie_refresh:"Cookie refresh",data_security_practices:"Data security practices",DATA_SHARED_WITH_THIRD_PARTIES:"Data shared with third parties",data_stewards:"Data stewards",declaration_name:"Declaration name",does_international_transfers:"Does international transfers",dpa_location:"DPA location",egress:"Destinations",exempt_from_privacy_regulations:"Exempt from privacy regulations",features:"Features",fides_key:"Fides key",flexible_legal_basis_for_processing:"Flexible legal basis for processing",impact_assessment_location:"Impact assessment location",ingress:"Sources",joint_controller_info:"Joint controller info",legal_basis_for_profiling:"Legal basis for profiling",legal_basis_for_transfers:"Legal basis for transfers",legitimate_interest_disclosure_url:"Legitimate interest disclosure URL",link_to_processor_contract:"Link to processor contract",processes_personal_data:"Processes personal data",reason_for_exemption:"Reason for exemption",requires_data_protection_assessments:"Requires data protection assessments",responsibility:"Responsibility",retention_period:"Retention period",shared_categories:"Shared categories",special_category_legal_basis:"Special category legal basis",system_dependencies:"System dependencies",third_country_safeguards:"Third country safeguards",third_parties:"Third parties",system_undeclared_data_categories:"System undeclared data categories",data_use_undeclared_data_categories:"Data use undeclared data categories",cookies:"Cookies",uses_cookies:"Uses cookies",uses_non_cookie_access:"Uses non-cookie access",uses_profiling:"Uses profiling"},m=(0,l.createContext)({}),S=e=>{let{children:t}=e,[s,a]=(0,u._)(r.CUSTOM_REPORT_ID,""),[i,c]=(0,u._)(r.GROUP_BY,_.fI.SYSTEM_DATA_USE),[d,p]=(0,u._)(r.FILTERS,{dataUses:[],dataSubjects:[],dataCategories:[]}),[S,g]=(0,u._)(r.COLUMN_ORDER,[]),[E,h]=(0,u._)(r.COLUMN_VISIBILITY,{[n.SYSTEM_UNDECLARED_DATA_CATEGORIES]:!1,[n.DATA_USE_UNDECLARED_DATA_CATEGORIES]:!1}),[x,f]=(0,u._)(r.COLUMN_SIZING,{}),[A,C]=(0,u._)(r.COLUMN_NAMES,{}),T=(0,l.useMemo)(()=>({savedCustomReportId:s,setSavedCustomReportId:a,groupBy:i,setGroupBy:c,selectedFilters:d,setSelectedFilters:p,columnOrder:S,setColumnOrder:g,columnVisibility:E,setColumnVisibility:h,columnSizing:x,setColumnSizing:f,columnNameMapOverrides:A,setColumnNameMapOverrides:C}),[s,a,i,c,d,p,S,g,E,h,x,f,A,C]);return(0,o.jsx)(m.Provider,{value:T,children:t})},g=()=>{let e=(0,l.useContext)(m);if(!e||0===Object.keys(e).length)throw Error("useDatamapReport must be used within a DatamapReportProvider");return e};var E=s(59003),h=s(92222),x=s(8540),f=s(69746),A=s(34090),C=s(66726),T=s.n(C),v=s(44296),b=s(19310),j=s(62528),R=s(38615),O=s(94167),I=s(12003),y=s(54321),D=e=>{let{children:t,heading:s,onCancel:a,onConfirm:i,isLoading:r,cancelButtonText:n,continueButtonText:l,"data-testid":c="standard-dialog",...d}=e,{onClose:u}=d;return(0,o.jsxs)(f.u_l,{closeOnOverlayClick:r,...d,children:[(0,o.jsx)(f.ZAr,{}),(0,o.jsxs)(f.hzk,{"data-testid":c,children:[s&&(0,o.jsx)(f.xBx,{children:s}),(0,o.jsx)(f.olH,{isDisabled:r,"data-testid":"standard-dialog-close-btn"}),t&&(0,o.jsx)(f.fef,{children:t}),(0,o.jsxs)(f.mzw,{gap:3,width:"100%",sx:{"& button":{width:"100%"}},children:[(0,o.jsx)(f.wpx,{onClick:()=>{a&&a(),u()},"data-testid":"".concat(c?"".concat(c,"-"):"","cancel-btn"),disabled:r,children:n||"Cancel"}),(0,o.jsx)(f.wpx,{onClick:i,type:"primary","data-testid":"".concat(c?"".concat(c,"-"):"","continue-btn"),loading:r,children:l||"Continue"})]})]})]})},N=s(31404),P=e=>{let[t,s]=(0,l.useState)(N.T2.csv),{onConfirm:a}=e;return(0,o.jsx)(D,{heading:"Export report",continueButtonText:"Download",size:"xl",...e,onConfirm:()=>a(t),"data-testid":"export-modal",children:(0,o.jsxs)(f.kCb,{direction:"column",gap:3,pb:3,children:[(0,o.jsx)(f.xvT,{textAlign:"left",children:"Export your data map report using the options below. Depending on the number of rows, the file may take a few minutes to process."}),(0,o.jsxs)(f.NIc,{children:[(0,o.jsx)(f.lXp,{htmlFor:"format",children:"Choose Format"}),(0,o.jsx)(f.WPr,{id:"format",value:t,onChange:s,"data-testid":"export-format-select",options:[{value:N.T2.csv,label:"CSV"},{value:N.T2.xlsx,label:"XLSX"}],className:"w-full"})]})]})})},M=s(72809),L=s(91650),w=s(79851),k=s(62091),U=s(35249);let H=e=>{let{label:t,children:s,...a}=e;return(0,o.jsxs)(f.Qdk,{...a,children:[(0,o.jsx)(f.X6q,{children:(0,o.jsxs)(f.KFZ,{height:"100%","data-testid":"filter-modal-accordion-button",textAlign:"left",fontWeight:600,children:[(0,o.jsx)(f.xuv,{flex:1,children:t}),(0,o.jsx)(f.XEm,{boxSize:7})]})}),(0,o.jsx)(f.Hk3,{children:s})]})},G=e=>{let{columnNameMap:t,selectedFilters:s,onFilterChange:a,onClose:i,...r}=e;(0,w.fd)(),(0,L.te)(),(0,U.MO)();let{dataUses:n,dataSubjects:c,dataCategories:d}=s,u=(0,v.C)(w.U3),_=(0,v.C)(L.ZL),p=(0,v.C)(U.qb),[m,S]=(0,l.useState)(n),[g,E]=(0,l.useState)(c),[h,x]=(0,l.useState)(d);(0,l.useEffect)(()=>{S(n)},[n]),(0,l.useEffect)(()=>{E(c)},[c]),(0,l.useEffect)(()=>{x(d)},[d]);let A=(0,l.useMemo)(()=>(0,k.Cd)(u),[u]),C=(0,l.useMemo)(()=>(0,k.Cd)(_),[_]),T=(0,l.useMemo)(()=>(0,k.Cd)(p),[p]);return(0,o.jsx)(D,{heading:"Filter Datamap Report",...r,onCancel:()=>{S([]),E([]),x([]),a({dataUses:[],dataSubjects:[],dataCategories:[]}),i()},onConfirm:()=>{a({dataUses:m,dataSubjects:g,dataCategories:h}),i()},onClose:i,cancelButtonText:"Reset filters",continueButtonText:"Done","data-testid":"datamap-report-filter-modal",children:(0,o.jsxs)(f.UQy,{allowToggle:!0,children:[(0,o.jsx)(H,{label:t.data_use,children:(0,o.jsx)(M.ZP,{nodes:A,selected:m,onSelected:S,"data-testid":"filter-modal-checkbox-tree-uses"})}),(0,o.jsx)(H,{label:t.data_categories,children:(0,o.jsx)(M.ZP,{nodes:T,selected:h,onSelected:x,"data-testid":"filter-modal-checkbox-tree-categories"})}),(0,o.jsx)(H,{label:t.data_subjects,children:(0,o.jsx)(M.ZP,{nodes:C,selected:g,onSelected:E,"data-testid":"filter-modal-checkbox-tree-subjects"})})]})})};var Y=s(96878),F=s(91591),V=s(60136),Z=s(79711);let{useGetMinimalCustomReportsQuery:z,useLazyGetCustomReportByIdQuery:W,usePostCustomReportMutation:B,useDeleteCustomReportMutation:q}=s(21618).u.injectEndpoints({endpoints:e=>({getMinimalCustomReports:e.query({query:e=>{let{pageIndex:t=1,pageSize:s=50,report_type:a=_.C2.DATAMAP}=e,i="page=".concat(t,"&size=").concat(s,"&report_type=").concat(a);return{url:"plus/custom-report/minimal?".concat(i)}},providesTags:["Custom Reports"]}),getCustomReportById:e.query({query:e=>({url:"plus/custom-report/".concat(e)}),providesTags:(e,t,s)=>[{type:"Custom Reports",id:s}]}),postCustomReport:e.mutation({query:e=>({method:"POST",url:"plus/custom-report",body:e}),invalidatesTags:["Custom Reports"]}),deleteCustomReport:e.mutation({query:e=>({method:"DELETE",url:"plus/custom-report/".concat(e)}),invalidatesTags:["Custom Reports"]})})});var X=s(59389),K=s(34803);let J="Report name",Q=e=>{let{isOpen:t,handleClose:s,tableStateToSave:a,columnMapToSave:i={},unavailableNames:r,onCreateCustomReport:n}=e,c=(0,f.pmc)(),[d]=B(),u=(0,l.useMemo)(()=>X.Ry().shape({reportName:X.Z_().label(J).required("Please provide a name for this report").test("is-unique","",async(e,t)=>null==r||!r.includes(e)||t.createError({message:"This name already exists"})).max(80,"Report name is too long (max 80 characters)")}),[r]),p=async e=>{var t;let r={};Object.entries(i).forEach(e=>{let[t,s]=e;r[t]={label:s,enabled:!0}}),Object.entries(null!==(t=null==a?void 0:a.columnVisibility)&&void 0!==t?t:{}).forEach(e=>{let[t,s]=e;r[t]||(r[t]={}),r[t].enabled=s});try{let t={name:e.trim(),type:_.C2.DATAMAP,config:{column_map:r,table_state:a}},i=await d(t);if((0,V.D4)(i))throw i.error;n(i.data),s()}catch(e){c({status:"error",description:(0,V.e$)(e,"A problem occurred while creating the report.")})}};return(0,o.jsxs)(f.u_l,{size:"lg",isOpen:t,onClose:s,motionPreset:"none",children:[(0,o.jsx)(f.ZAr,{}),(0,o.jsxs)(f.hzk,{children:[(0,o.jsx)(f.xBx,{pb:0,children:"Create a report"}),(0,o.jsx)(A.J9,{initialValues:{reportName:""},onSubmit:e=>p(e.reportName),onReset:s,validateOnBlur:!1,validationSchema:u,children:e=>{let{dirty:t,isValid:s}=e;return(0,o.jsxs)(A.l0,{"data-testid":"custom-report-form",children:[(0,o.jsxs)(f.fef,{children:[(0,o.jsx)(f.xvT,{fontSize:"sm",color:"gray.600",pb:6,children:"Customize and save your current filter settings for easy access in the future. This saved report will include the column layout and currently applied filter settings."}),(0,o.jsx)(K.j0,{id:"reportName",name:"reportName",isRequired:!0,label:J,placeholder:"Enter a name for the report...",variant:"stacked",maxLength:80})]}),(0,o.jsxs)(f.mzw,{gap:2,children:[(0,o.jsx)(f.wpx,{size:"small",htmlType:"reset",children:"Cancel"}),(0,o.jsx)(f.wpx,{size:"small",disabled:!t||!s,type:"primary","data-testid":"custom-report-form-submit",htmlType:"submit",children:"Save"})]})]})}})]})]})},$="Report",ee="Reports",et=e=>{var t;let{reportType:s,savedReportId:a,tableStateToSave:i,currentColumnMap:r,onCustomReportSaved:n,onSavedReportDeleted:c}=e,d=(0,R.Tg)([_.Sh.CUSTOM_REPORT_CREATE]),u=(0,R.Tg)([_.Sh.CUSTOM_REPORT_DELETE]),p=(0,f.pmc)({id:"custom-report-toast"}),{data:m,isLoading:S}=z({report_type:s}),[g,E]=(0,l.useState)(),[h]=W(),[x]=q(),{isOpen:C,onToggle:T,onOpen:v,onClose:b}=(0,f.qY0)(),{isOpen:j,onOpen:O,onClose:I}=(0,f.qY0)(),{isOpen:y,onOpen:D,onClose:N}=(0,f.qY0)(),[P,M]=(0,l.useState)(),[L,w]=(0,l.useState)(),[k,U]=(0,l.useState)(),[H,G]=(0,l.useState)(!1),Y=(0,l.useMemo)(()=>{var e;let t=null==m?void 0:null===(e=m.items.find(e=>e.id===a))||void 0===e?void 0:e.name;return null!=t?t:ee},[null==m?void 0:m.items,a]),B=!S&&!(null==m?void 0:null===(t=m.items)||void 0===t?void 0:t.length),X=e=>{E(null==m?void 0:m.items.filter(t=>t.name.toLowerCase().includes(e.toLowerCase())))},K=async e=>{M(e);let{data:t,isError:s,error:a}=await h(e);if(s){let e=(0,V.e$)(a,"A problem occurred while fetching the ".concat($,"."));e.includes("not found")&&c(),p({status:"error",description:e})}else w(t)},J=()=>{M(""),w(void 0),G(!1)},et=()=>{L?(G(!1),L.id!==a&&n(L),b()):P?G(!0):(n(null),b())},es=async e=>{e===(null==L?void 0:L.id)&&(J(),c()),x(e)};(0,l.useEffect)(()=>{m&&E(m.items)},[m]),(0,l.useEffect)(()=>{H&&(G(!1),et())},[L]),(0,l.useEffect)(()=>{a?K(a):J()},[a]),(0,l.useEffect)(()=>{k&&D()},[D,k]);let ea=!L&&!a||(null==L?void 0:L.id)===a;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(f.J2e,{placement:"bottom-end",isOpen:C,onClose:et,id:"custom-reports-selection",children:[(0,o.jsx)(f.xol,{children:(0,o.jsx)(f.wpx,{size:"small",className:"max-w-40",icon:(0,o.jsx)(f.v4q,{}),iconPosition:"end","data-testid":"custom-reports-trigger",onClick:T,children:(0,o.jsx)(f.xvT,{noOfLines:1,display:"inline-block",children:Y})})}),(0,o.jsx)(f.h_i,{children:(0,o.jsxs)(f.yky,{"data-testid":"custom-reports-popover",children:[(0,o.jsx)(f.QHN,{}),(0,o.jsx)(A.J9,{initialValues:{},onSubmit:et,onReset:J,children:(0,o.jsxs)(A.l0,{children:[(0,o.jsx)(f.wpx,{size:"small",disabled:B,htmlType:"reset",className:"absolute left-2 top-2","data-testid":"custom-reports-reset-button",children:"Reset"}),(0,o.jsxs)(f.Ytg,{textAlign:"center",children:[(0,o.jsx)(f.xvT,{fontSize:"sm",children:ee}),(0,o.jsx)(f.BZy,{size:"sm",mt:3,children:(0,o.jsx)(f.IIB,{type:"text",borderRadius:"md",placeholder:"Search...",onChange:e=>X(e.target.value)})})]}),(0,o.jsx)(f.usR,{top:2,onClick:()=>{a?K(a):J(),b()},"data-testid":"custom-report-popover-cancel"}),(0,o.jsxs)(f.baG,{px:6,pt:5,pb:1,children:[B&&(0,o.jsxs)(f.gCW,{px:2,pt:6,pb:3,"data-testid":"custom-reports-empty-state",children:[(0,o.jsx)(f.hU,{variant:"primary",backgroundColor:"gray.500",isRound:!0,size:"xs","aria-label":"add ".concat($),icon:(0,o.jsx)(F.d,{}),onClick:O,"data-testid":"add-report-button"}),(0,o.jsxs)(f.xvT,{fontSize:"sm",textAlign:"center",color:"gray.500",children:["No ",ee.toLowerCase()," have been created. Start by applying your preferred filter and column settings, then create a"," ",$.toLowerCase()," for easy access later."]})]}),!B&&(S?(0,o.jsxs)(f.gCW,{pb:2,children:[(0,o.jsx)(f.OdW,{width:"100%",height:f.rSc.space[4]}),(0,o.jsx)(f.OdW,{width:"100%",height:f.rSc.space[4]}),(0,o.jsx)(f.OdW,{width:"100%",height:f.rSc.space[4]})]}):(0,o.jsx)(f.FXm,{onChange:K,value:P,display:"flex",flexDirection:"column",gap:2,colorScheme:"minos",children:null==g?void 0:g.map(e=>(0,o.jsxs)(f.Ugi,{justifyContent:u?"space-between":"flex-start","min-height":f.rSc.space[6],color:"gray.700",children:[(0,o.jsx)(f.Y8K,{name:"custom-report-id",value:e.id,"data-testid":"custom-report-item",children:(0,o.jsx)(f.xvT,{fontSize:"sm",children:e.name})}),u&&(0,o.jsx)(f.hU,{variant:"ghost",size:"xs","aria-label":"delete ".concat($),icon:(0,o.jsx)(Z.q,{fontSize:16}),onClick:()=>{U(e)},"data-testid":"delete-report-button",color:"gray.700"})]},e.id))}))]}),(0,o.jsx)(f.DT9,{border:"none",px:6,pb:4,pt:4,children:(0,o.jsxs)(f.Ugi,{children:[d&&i&&(0,o.jsxs)(f.wpx,{size:"small",onClick:O,className:"w-full","data-testid":"create-report-button",htmlType:"button",children:["+ Create ",$.toLowerCase()]}),(0,o.jsx)(f.wpx,{size:"small",type:"primary",loading:H,disabled:ea,className:"w-full","data-testid":"apply-report-button",htmlType:"submit",children:"Apply"})]})})]})})]})})]}),(0,o.jsx)(Q,{isOpen:j,handleClose:()=>{I(),setTimeout(()=>{v()},100)},tableStateToSave:i,columnMapToSave:r,unavailableNames:null==m?void 0:m.items.map(e=>e.name),onCreateCustomReport:n}),(0,o.jsx)(f.cVQ,{isOpen:y,onClose:()=>{U(void 0),N()},onConfirm:()=>{k&&es(k.id),N()},title:"Delete ".concat($),message:(0,o.jsxs)(f.xvT,{children:["You are about to permanently delete the"," ",$.toLowerCase()," named"," ",(0,o.jsx)("strong",{children:null==k?void 0:k.name}),". Are you sure you would like to continue?"]})})]})};var es=s(19785),ea=s.n(es),ei=s(55807),er=s.n(ei),en=s(32526),eo=s.n(en),el=s(98320),ec=s(71533);let ed=(0,h.Cl)(),eu=(e,t)=>({cell:e=>(0,o.jsx)(x.G3,{value:e.getValue()}),header:s=>{let a={};return Object.keys(e).forEach(t=>{"string"==typeof e[t]?a[t]=e[t]:e[t].label&&(a[t]=e[t].label||"")}),(0,o.jsx)(el.Hm,{value:(0,ec.AH)({columnId:s.column.id,columnNameMap:a}),defaultValue:p[s.column.id]||(0,ec.AH)({columnId:s.column.id}),isEditing:t,...s})}}),e_=(e,t)=>{var s;let a=(null==e?void 0:null===(s=e.items)||void 0===s?void 0:s.length)?Object.keys(e.items[0]):[],i=Object.values(n);return a.filter(e=>!i.includes(e)).filter(e=>e.startsWith("privacy_declaration_")||e.startsWith("system_")).map(e=>{let s=t.find(t=>e.includes(eo()(t.name)));return ed.accessor(t=>t[e],{id:e,cell:e=>Array.isArray(e.getValue())?(0,o.jsx)(x.WP,{value:e.getValue(),ignoreZero:!0,badgeProps:{variant:"outline"},...e}):(0,o.jsx)(x.G3,{value:e.getValue()}),meta:{showHeaderMenu:(null==s?void 0:s.field_type)==="string[]"}})})},ep=e=>{let{onSelectRow:t,getDataUseDisplayName:s,getDataCategoryDisplayName:a,getDataSubjectDisplayName:i,datamapReport:r,customFields:l,isRenaming:c=!1}=e,d=e_(r,l);return[ed.accessor(e=>e.system_name,{enableGrouping:!0,id:n.SYSTEM_NAME,meta:{onCellClick:t}}),ed.accessor(e=>e.data_uses,{id:n.DATA_USE,cell:e=>{let t=e.getValue();return(0,o.jsx)(x.WP,{suffix:"data uses",ignoreZero:!0,value:ea()(t)?er()(t,s):s(t||""),badgeProps:{variant:"outline"},...e})},meta:{width:"auto"}}),ed.accessor(e=>e.data_categories,{id:n.DATA_CATEGORY,cell:e=>{let t=e.getValue();if(!t||0===t.length)return null;let s=ea()(t)?t.map(e=>({label:a(e),key:e})):[{label:a(t),key:t}];return(0,o.jsx)(el.mb,{values:s,cellProps:e,variant:"outline"})},meta:{showHeaderMenu:!c,showHeaderMenuWrapOption:!0,width:"auto",overflow:"hidden"}}),ed.accessor(e=>e.data_subjects,{id:n.DATA_SUBJECT,cell:e=>{let t=e.getValue();return(0,o.jsx)(x.WP,{suffix:"data subjects",ignoreZero:!0,value:ea()(t)?er()(t,i):i(t||""),badgeProps:{variant:"outline"},...e})},meta:{showHeaderMenu:!c}}),ed.accessor(e=>e.legal_name,{id:n.LEGAL_NAME}),ed.accessor(e=>e.dpo,{id:n.DPO}),ed.accessor(e=>e.legal_basis_for_processing,{id:n.LEGAL_BASIS_FOR_PROCESSING}),ed.accessor(e=>e.administrating_department,{id:n.ADMINISTRATING_DEPARTMENT}),ed.accessor(e=>e.cookie_max_age_seconds,{id:n.COOKIE_MAX_AGE_SECONDS}),ed.accessor(e=>e.privacy_policy,{id:n.PRIVACY_POLICY}),ed.accessor(e=>e.legal_address,{id:n.LEGAL_ADDRESS}),ed.accessor(e=>e.cookie_refresh,{id:n.COOKIE_REFRESH}),ed.accessor(e=>e.data_security_practices,{id:n.DATA_SECURITY_PRACTICES}),ed.accessor(e=>e.data_shared_with_third_parties,{id:n.DATA_SHARED_WITH_THIRD_PARTIES}),ed.accessor(e=>e.data_stewards,{id:n.DATA_STEWARDS,cell:e=>(0,o.jsx)(x.WP,{suffix:"data stewards",ignoreZero:!0,value:e.getValue(),badgeProps:{variant:"outline"},...e}),meta:{showHeaderMenu:!c,width:"auto"}}),ed.accessor(e=>e.declaration_name,{id:n.DECLARATION_NAME}),ed.accessor(e=>e.does_international_transfers,{id:n.DOES_INTERNATIONAL_TRANSFERS}),ed.accessor(e=>e.dpa_location,{id:n.DPA_LOCATION}),ed.accessor(e=>e.egress,{id:n.DESTINATIONS,cell:e=>(0,o.jsx)(x.WP,{suffix:"destinations",ignoreZero:!0,value:e.getValue(),badgeProps:{variant:"outline"},...e}),meta:{showHeaderMenu:!c,width:"auto"}}),ed.accessor(e=>e.exempt_from_privacy_regulations,{id:n.EXEMPT_FROM_PRIVACY_REGULATIONS}),ed.accessor(e=>e.features,{id:n.FEATURES,cell:e=>(0,o.jsx)(x.WP,{suffix:"features",ignoreZero:!0,value:e.getValue(),badgeProps:{variant:"outline"},...e}),meta:{showHeaderMenu:!c,width:"auto"}}),ed.accessor(e=>e.fides_key,{id:n.FIDES_KEY}),ed.accessor(e=>e.flexible_legal_basis_for_processing,{id:n.FLEXIBLE_LEGAL_BASIS_FOR_PROCESSING}),ed.accessor(e=>e.impact_assessment_location,{id:n.IMPACT_ASSESSMENT_LOCATION}),ed.accessor(e=>e.ingress,{id:n.SOURCES,cell:e=>(0,o.jsx)(x.WP,{suffix:"sources",ignoreZero:!0,value:e.getValue(),badgeProps:{variant:"outline"},...e}),meta:{showHeaderMenu:!c,width:"auto"}}),ed.accessor(e=>e.joint_controller_info,{id:n.JOINT_CONTROLLER_INFO}),ed.accessor(e=>e.legal_basis_for_profiling,{id:n.LEGAL_BASIS_FOR_PROFILING,cell:e=>(0,o.jsx)(x.WP,{suffix:"profiles",ignoreZero:!0,value:e.getValue(),badgeProps:{variant:"outline"},...e}),meta:{showHeaderMenu:!c,width:"auto"}}),ed.accessor(e=>e.legal_basis_for_transfers,{id:n.LEGAL_BASIS_FOR_TRANSFERS,cell:e=>(0,o.jsx)(x.WP,{suffix:"transfers",ignoreZero:!0,value:e.getValue(),badgeProps:{variant:"outline"},...e}),meta:{showHeaderMenu:!c,width:"auto"}}),ed.accessor(e=>e.legitimate_interest_disclosure_url,{id:n.LEGITIMATE_INTEREST_DISCLOSURE_URL}),ed.accessor(e=>e.link_to_processor_contract,{id:n.LINK_TO_PROCESSOR_CONTRACT}),ed.accessor(e=>e.processes_personal_data,{id:n.PROCESSES_PERSONAL_DATA}),ed.accessor(e=>e.reason_for_exemption,{id:n.REASON_FOR_EXEMPTION}),ed.accessor(e=>e.requires_data_protection_assessments,{id:n.REQUIRES_DATA_PROTECTION_ASSESSMENTS}),ed.accessor(e=>e.responsibility,{id:n.RESPONSIBILITY,cell:e=>(0,o.jsx)(x.WP,{suffix:"responsibilities",ignoreZero:!0,value:e.getValue(),badgeProps:{variant:"outline"},...e}),meta:{showHeaderMenu:!c,width:"auto"}}),ed.accessor(e=>e.retention_period,{id:n.RETENTION_PERIOD}),ed.accessor(e=>e.shared_categories,{id:n.SHARED_CATEGORIES,cell:e=>(0,o.jsx)(x.WP,{suffix:"shared categories",ignoreZero:!0,value:e.getValue(),badgeProps:{variant:"outline"},...e}),meta:{showHeaderMenu:!c,width:"auto"}}),ed.accessor(e=>e.special_category_legal_basis,{id:n.SPECIAL_CATEGORY_LEGAL_BASIS}),ed.accessor(e=>e.system_dependencies,{id:n.SYSTEM_DEPENDENCIES,cell:e=>(0,o.jsx)(x.WP,{suffix:"dependencies",ignoreZero:!0,value:e.getValue(),...e}),meta:{showHeaderMenu:!c,width:"auto"}}),ed.accessor(e=>e.third_country_safeguards,{id:n.THIRD_COUNTRY_SAFEGUARDS}),ed.accessor(e=>e.third_parties,{id:n.THIRD_PARTIES}),ed.accessor(e=>e.system_undeclared_data_categories,{id:n.SYSTEM_UNDECLARED_DATA_CATEGORIES,cell:e=>{let t=e.getValue();if(!t||0===t.length)return null;let s=ea()(t)?t.map(e=>({label:a(e),key:e})):[{label:a(t),key:t}];return(0,o.jsx)(el.mb,{values:s,cellProps:e,variant:"outline"})},meta:{showHeaderMenu:!c,showHeaderMenuWrapOption:!0,width:"auto",overflow:"hidden"}}),ed.accessor(e=>e.data_use_undeclared_data_categories,{id:n.DATA_USE_UNDECLARED_DATA_CATEGORIES,cell:e=>{let t=e.getValue();if(!t||0===t.length)return null;let s=ea()(t)?t.map(e=>({label:a(e),key:e})):[{label:a(t),key:t}];return(0,o.jsx)(el.mb,{values:s,cellProps:e,variant:"outline"})},meta:{showHeaderMenu:!c,showHeaderMenuWrapOption:!0,width:"auto",overflow:"hidden"}}),ed.accessor(e=>e.cookies,{id:n.COOKIES,cell:e=>(0,o.jsx)(x.WP,{ignoreZero:!0,suffix:"cookies",value:e.getValue(),badgeProps:{variant:"outline"},...e}),meta:{showHeaderMenu:!c,width:"auto"}}),ed.accessor(e=>e.uses_cookies,{id:n.USES_COOKIES}),ed.accessor(e=>e.uses_non_cookie_access,{id:n.USES_NON_COOKIE_ACCESS}),ed.accessor(e=>e.uses_profiling,{id:n.USES_PROFILING}),...d]},em=e=>e===_.fI.DATA_USE_SYSTEM?[n.DATA_USE]:[n.SYSTEM_NAME],eS=(e,t)=>{let s=[];return _.fI.SYSTEM_DATA_USE===e&&(s=[n.SYSTEM_NAME,n.DATA_USE]),_.fI.DATA_USE_SYSTEM===e&&(s=[n.DATA_USE,n.SYSTEM_NAME]),s=s.concat(t.filter(e=>e!==n.SYSTEM_NAME&&e!==n.DATA_USE))},eg=e=>{let t=[];return _.fI.SYSTEM_DATA_USE===e&&(t=[n.SYSTEM_NAME,n.DATA_USE]),_.fI.DATA_USE_SYSTEM===e&&(t=[n.DATA_USE,n.SYSTEM_NAME]),t},eE={items:[],total:0,page:1,size:25,pages:1},eh=()=>{let e=(0,R.Tg)([_.Sh.CUSTOM_REPORT_READ]),{isLoading:t}=(0,Y.x8)(),{PAGE_SIZES:s,pageSize:a,setPageSize:i,onPreviousPageClick:n,isPreviousPageDisabled:c,onNextPageClick:d,isNextPageDisabled:u,startRange:m,endRange:S,pageIndex:C,setTotalPages:D,resetPageIndexToDefault:N}=(0,x.oi)(),M=(0,f.pmc)({id:"datamap-report-toast"}),{isOpen:L,onClose:w,onOpen:k}=(0,f.qY0)(),{getDataUseDisplayName:U,getDataCategoryDisplayName:H,getDataSubjectDisplayName:F,isLoading:V}=(0,b.Z)(),[Z,z]=(0,l.useState)(),{savedCustomReportId:W,setSavedCustomReportId:B,groupBy:q,setGroupBy:X,selectedFilters:K,setSelectedFilters:J,columnOrder:Q,setColumnOrder:$,columnVisibility:ee,setColumnVisibility:es,columnSizing:ea,setColumnSizing:ei,columnNameMapOverrides:er,setColumnNameMapOverrides:en}=g(),[eo,el]=(0,l.useState)(!1),ec=e=>{B(""),X(e),el(!0),N()},[ed,e_]=(0,l.useState)(""),eh=(0,l.useCallback)(e=>{N(),e_(e)},[N,e_]),ex={pageIndex:C,pageSize:a,groupBy:q,search:ed,dataUses:(0,O.du)(K.dataUses,"data_uses"),dataSubjects:(0,O.du)(K.dataSubjects,"data_subjects"),dataCategories:(0,O.du)(K.dataCategories,"data_categories")},{data:ef,isLoading:eA,isFetching:eC}=(0,I.tH)(ex),[eT,{isLoading:ev,isSuccess:eb}]=(0,I.Eo)(),{data:ej,totalRows:eR}=(0,l.useMemo)(()=>{let e=ef||eE,t=e.items;return eo&&el(!1),D(e.pages),{totalRows:e.total,data:t}},[ef]);(0,Y.GH)();let eO=(0,v.C)(Y.fN),[eI,ey]=(0,l.useState)(!1),eD=(0,l.useMemo)(()=>ep({onSelectRow:e=>z(e.fides_key),getDataUseDisplayName:U,getDataCategoryDisplayName:H,getDataSubjectDisplayName:F,datamapReport:ef,customFields:eO,isRenaming:eI}),[U,F,H,ef,eO,eI]);(0,l.useEffect)(()=>{var e;(null==ef?void 0:null===(e=ef.items)||void 0===e?void 0:e.length)&&$(eS(q,Object.keys(ef.items[0])))},[q,ef]);let{isOpen:eN,onOpen:eP,onClose:eM}=(0,f.qY0)(),{isOpen:eL,onOpen:ew,onClose:ek}=(0,f.qY0)(),eU=(0,E.b7)({getCoreRowModel:(0,h.sC)(),getGroupedRowModel:(0,h.qe)(),getExpandedRowModel:(0,h.rV)(),manualPagination:!0,enableColumnResizing:!0,columnResizeMode:"onChange",columns:eD,defaultColumn:eu({...p,...er},eI),data:ej,initialState:{expanded:!0,columnSizing:ea,columnOrder:Q,columnVisibility:ee,grouping:em(q)}});(0,l.useEffect)(()=>{let e=em(q);ef&&eU.setGrouping(e)},[ef]);let eH=(0,l.useMemo)(()=>T()(ei,300),[ei]);(0,l.useEffect)(()=>{let e=eU.getState().columnSizing;e&&eH(e)},[eU.getState().columnSizing]);let eG=()=>{switch(q){case _.fI.SYSTEM_DATA_USE:return"system";case _.fI.DATA_USE_SYSTEM:return"data use";default:return"system"}},eY=(e,t)=>{if(!e){B("");return}try{var s,a,i,r;if(null===(s=e.config)||void 0===s?void 0:s.table_state){let{groupBy:t,filters:s,columnOrder:a}=e.config.table_state,r={};Object.entries(null!==(i=e.config.column_map)&&void 0!==i?i:{}).forEach(e=>{let[t,s]=e;r[t]=s.enabled||!1}),t&&(X(t),eU.setGrouping(em(t))),s&&J(s),a&&($(a),eU.setColumnOrder(a)),r&&(es(r),eU.setColumnVisibility(r))}if(null===(a=e.config)||void 0===a?void 0:a.column_map){let s={};Object.entries(null!==(r=e.config.column_map)&&void 0!==r?r:{}).forEach(e=>{let[t,a]=e;a.label&&(s[t]=a.label)}),en(s),t({values:s})}B(e.id),M({status:"success",description:"Report applied successfully."})}catch(e){M({status:"error",description:"There was a problem applying report."})}};return eA||t||V?(0,o.jsx)(x.I4,{rowHeight:36,numRows:15}):(0,o.jsxs)(f.kCb,{flex:1,direction:"column",overflow:"auto",children:[(0,o.jsx)(G,{columnNameMap:{...p,...er},selectedFilters:K,isOpen:L,onClose:w,onFilterChange:e=>{B(""),J(e)}}),(0,o.jsx)(x.F1,{isOpen:eN,onClose:eM,headerText:"Data map settings",columnNameMap:{...p,...er},prefixColumns:eg(q),tableInstance:eU,savedCustomReportId:W,onColumnOrderChange:e=>{B(""),eU.setColumnOrder(e),$(e)},onColumnVisibilityChange:e=>{B(""),eU.setColumnVisibility(e),es(e)}}),(0,o.jsx)(P,{isOpen:eL,onClose:ek,onConfirm:e=>{let t={};Object.entries(ee).forEach(e=>{let[s,a]=e;t[s]={enabled:a}}),Object.entries(er).forEach(e=>{let[s,a]=e;if(t[s])t[s].label=a;else{var i;t[s]={label:a,enabled:null===(i=ee[s])||void 0===i||i}}}),eT({...ex,format:e,report_id:W,report:{name:"",type:"datamap",config:{column_map:t,table_state:{groupBy:q,filters:K,columnOrder:Q}}}}).then(()=>{eb&&ek()})},isLoading:ev}),(0,o.jsx)(A.J9,{initialValues:er,onSubmit:e=>{B(""),en(e),ey(!1)},children:t=>{let{submitForm:s,resetForm:a}=t;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(x.Q$,{children:[(0,o.jsx)(x.HO,{globalFilter:ed,setGlobalFilter:eh,placeholder:"System name, Fides key, or ID"}),(0,o.jsxs)(f.kCb,{alignItems:"center",gap:2,children:[e&&(0,o.jsx)(et,{reportType:_.C2.DATAMAP,savedReportId:W,tableStateToSave:{groupBy:q,filters:K,columnOrder:Q,columnVisibility:ee},currentColumnMap:er,onCustomReportSaved:e=>eY(e,a),onSavedReportDeleted:()=>{B("")}}),(0,o.jsxs)(f.v2r,{children:[(0,o.jsxs)(f.j2t,{as:f.wpx,size:"small",icon:(0,o.jsx)(f.v4q,{}),iconPosition:"end",loading:eo,"data-testid":"group-by-menu",children:["Group by ",eG()]}),(0,o.jsxs)(f.qyq,{zIndex:11,"data-testid":"group-by-menu-list",children:[(0,o.jsx)(f.iiZ,{onClick:()=>{ec(_.fI.SYSTEM_DATA_USE)},isChecked:_.fI.SYSTEM_DATA_USE===q,value:_.fI.SYSTEM_DATA_USE,"data-testid":"group-by-system-data-use",children:"System"}),(0,o.jsx)(f.iiZ,{onClick:()=>{ec(_.fI.DATA_USE_SYSTEM)},isChecked:_.fI.DATA_USE_SYSTEM===q,value:_.fI.DATA_USE_SYSTEM,"data-testid":"group-by-data-use-system",children:"Data use"})]})]}),(0,o.jsx)(f.wpx,{"data-testid":"filter-multiple-systems-btn",size:"small",onClick:k,children:"Filter"}),(0,o.jsx)(f.wpx,{"aria-label":"Export report","data-testid":"export-btn",size:"small",onClick:ew,icon:(0,o.jsx)(j.nM,{ml:"1.5px"})}),(0,o.jsxs)(f.v2r,{placement:"bottom-end",children:[(0,o.jsx)(f.j2t,{as:f.wpx,size:"small",icon:(0,o.jsx)(f.nXP,{className:"rotate-90"}),"data-testid":"more-menu","aria-label":"More options",className:"w-6 gap-0"}),(0,o.jsxs)(f.qyq,{"data-testid":"more-menu-list",children:[(0,o.jsx)(f.sNh,{onClick:eP,"data-testid":"edit-columns-btn",children:"Edit columns"}),(0,o.jsx)(f.sNh,{onClick:()=>ey(!0),"data-testid":"rename-columns-btn",children:"Rename columns"})]})]}),eI&&(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)(f.wpx,{size:"small","data-testid":"rename-columns-reset-btn",onClick:()=>{en({}),B(""),a({values:{}}),ey(!1)},children:"Reset all"}),(0,o.jsx)(f.wpx,{size:"small","data-testid":"rename-columns-cancel-btn",onClick:()=>{a({values:er}),ey(!1)},children:"Cancel"}),(0,o.jsx)(f.wpx,{size:"small",type:"primary",htmlType:"submit","data-testid":"rename-columns-apply-btn",onClick:s,children:"Apply"})]})]})]}),(0,o.jsx)(A.l0,{children:(0,o.jsx)(x.ZK,{tableInstance:eU,columnExpandStorageKey:r.COLUMN_EXPANSION_STATE,columnWrapStorageKey:r.WRAPPING_COLUMNS})})]})}}),(0,o.jsx)(x.s8,{totalRows:eR||0,pageSizes:s,setPageSize:i,onPreviousPageClick:n,isPreviousPageDisabled:c||eC,onNextPageClick:d,isNextPageDisabled:u||eC,startRange:m,endRange:S}),(0,o.jsx)(y.Z,{selectedSystemId:Z,resetSelectedSystemId:()=>z(void 0)})]})};var ex=()=>(0,o.jsxs)(c.Z,{title:"Datamap Report",mainProps:{padding:"0 40px 24px"},children:[(0,o.jsx)(d.Z,{"data-testid":"datamap-report-heading",breadcrumbs:[{title:"Data map report"}]}),(0,o.jsx)(S,{children:(0,o.jsx)(eh,{})})]})}},function(e){e.O(0,[8033,6451,4554,2866,9278,3967,8540,7827,2017,4321,2888,9774,179],function(){return e(e.s=86548)}),_N_E=e.O()}]);