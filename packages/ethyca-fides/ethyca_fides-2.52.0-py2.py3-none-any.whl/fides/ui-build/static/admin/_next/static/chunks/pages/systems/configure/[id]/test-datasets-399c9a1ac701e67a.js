(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1617],{19785:function(e){var t=Array.isArray;e.exports=t},54543:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/systems/configure/[id]/test-datasets",function(){return n(37285)}])},81836:function(e,t,n){"use strict";var i=n(24246),r=n(27378),s=n(69746),a=n(79894),l=n.n(a);t.Z=e=>{let{breadcrumbs:t,fontSize:n="2xl",fontWeight:a="semibold",separator:o="->",lastItemStyles:u={color:"black"},normalItemStyles:c={color:"gray.500"},...d}=e;return(0,i.jsx)(s.aGc,{separator:o,fontSize:n,fontWeight:a,"data-testid":"breadcrumbs",...d,children:t.map((e,n)=>{let a=n+1===t.length;return e.title?(0,r.createElement)(s.gN6,{...c,...a?u:{},key:e.title,children:[(null==e?void 0:e.icon)&&(0,i.jsx)(s.xuv,{mr:2,children:e.icon}),e.link?(0,i.jsx)(s.Atw,{as:l(),href:e.link,isCurrentPage:a,children:e.title}):(0,i.jsx)(s.Atw,{_hover:{textDecoration:"none",cursor:"default"},isCurrentPage:a,children:e.title})]}):null})})}},58665:function(e,t,n){"use strict";var i=n(24246),r=n(69746);t.Z=e=>{let{...t}=e;return(0,i.jsx)(r.kCb,{boxSize:"full",align:"center",justify:"center",children:(0,i.jsx)(r.$jN,{color:"primary",...t})})}},43124:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var i=n(24246),r=n(69746),s=n(88038),a=n.n(s),l=n(86677);n(27378);var o=n(11596),u=n(72247),c=n(11032),d=()=>{let e=(0,l.useRouter)();return(0,i.jsx)(r.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,i.jsxs)(r.xuv,{children:[(0,i.jsxs)(r.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,i.jsx)(r.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,i.jsx)(r.wpx,{onClick:()=>{e.push(c.fz)},children:"Configure"})]}),(0,i.jsxs)(r.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},f=e=>{let{children:t,title:n,padded:s=!0,mainProps:c}=e,f=(0,o.hz)(),h=(0,l.useRouter)(),y="/privacy-requests"===h.pathname||"/datastore-connection"===h.pathname,m=!(f.flags.privacyRequestsConfiguration&&y),{data:g}=(0,u.JE)(void 0,{skip:m}),{data:p}=(0,u.PW)(void 0,{skip:m}),v=f.flags.privacyRequestsConfiguration&&(!g||!p)&&y;return(0,i.jsxs)(r.kCb,{"data-testid":n,direction:"column",h:"100vh",children:[(0,i.jsxs)(a(),{children:[(0,i.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,i.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,i.jsxs)(r.kCb,{as:"main",direction:"column",py:s?6:0,px:s?10:0,h:s?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...c,children:[v?(0,i.jsx)(d,{}):null,t]})]})}},37541:function(e,t,n){"use strict";var i=n(24246),r=n(69746),s=n(19785),a=n.n(s),l=n(27378),o=n(81836);t.Z=e=>{let{breadcrumbs:t,isSticky:n=!0,children:s,rightContent:u,...c}=e;return(0,i.jsxs)(r.xuv,{bgColor:"white",paddingY:5,...n?{position:"sticky",top:0,left:0,zIndex:10}:{},...c,children:[(0,i.jsxs)(r.kCb,{alignItems:"flex-start",children:[(0,i.jsxs)(r.xuv,{flex:1,children:[a()(t)&&(0,i.jsx)(r.xuv,{marginBottom:s?4:0,children:(0,i.jsx)(o.Z,{breadcrumbs:t})}),(0,l.isValidElement)(t)&&t]}),u&&(0,i.jsx)(r.xuv,{children:u})]}),s]})}},60136:function(e,t,n){"use strict";n.d(t,{D4:function(){return s.D4},MM:function(){return f},Ot:function(){return u},c6:function(){return r},cj:function(){return y},e$:function(){return l},fn:function(){return o},iC:function(){return h},nU:function(){return d},tB:function(){return c}});var i,r,s=n(41164);let a="An unexpected error occurred. Please try again.",l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;if((0,s.Bw)(e)){if((0,s.hE)(e.data))return e.data.detail;if((0,s.cz)(e.data)){var n;let t=null===(n=e.data.detail)||void 0===n?void 0:n[0];return"".concat(null==t?void 0:t.msg,": ").concat(null==t?void 0:t.loc)}if(409===e.status&&(0,s.Dy)(e.data)||404===e.status&&(0,s.XD)(e.data))return"".concat(e.data.detail.error," (").concat(e.data.detail.fides_key,")")}return t};function o(e){return"object"==typeof e&&null!=e&&"status"in e}function u(e){return"object"==typeof e&&null!=e&&"data"in e&&"string"==typeof e.data.detail}function c(e){return"object"==typeof e&&null!=e&&"data"in e&&Array.isArray(e.data.detail)}let d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{status:500,message:a};if((0,s.oK)(e))return{status:e.originalStatus,message:e.data};if((0,s.Bw)(e)){let{status:n}=e;return{status:n,message:l(e,t.message)}}return t},f=e=>Object.entries(e).map(e=>({value:e[1],label:e[1]}));(i=r||(r={})).GVL="gvl",i.AC="gacp",i.COMPASS="compass";let h={gvl:{label:"GVL",fullName:"Global Vendor List"},gacp:{label:"AC",fullName:"Google Additional Consent List"},compass:{label:"",fullName:""}},y=e=>{let t=e.split(".")[0];return"gacp"===t?"gacp":"gvl"===t?"gvl":"compass"}},16781:function(e,t,n){"use strict";n.d(t,{MA:function(){return l},Vo:function(){return u},t5:function(){return o}});var i=n(24246),r=n(69746);let s=e=>{let{children:t}=e;return(0,i.jsxs)(r.xvT,{"data-testid":"toast-success-msg",children:[(0,i.jsx)("strong",{children:"Success:"})," ",t]})},a=e=>{let{children:t}=e;return(0,i.jsxs)(r.xvT,{"data-testid":"toast-error-msg",children:[(0,i.jsx)("strong",{children:"Error:"})," ",t]})},l={variant:"subtle",position:"top",description:"",duration:5e3,status:"success",isClosable:!0},o=e=>{let t=(0,i.jsx)(s,{children:e});return{...l,description:t}},u=e=>{let t=(0,i.jsx)(a,{children:e});return{...l,description:t,status:"error"}}},12719:function(e,t,n){"use strict";n.d(t,{F:function(){return a},M:function(){return s}});var i=n(76649),r=n(65218);let s=n.n(r)()(()=>n.e(7088).then(n.bind(n,57088)).then(e=>e.default),{loadableGenerated:{webpack:()=>[57088]},ssr:!1}),a=e=>(0,i.Ln)({name:"string"},e)&&"YAMLException"===e.name},37285:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return N}});var i=n(24246),r=n(69746),s=n(86677),a=n(27378),l=n(44296),o=n(58665),u=n(43124),c=n(11032),d=n(37541),f=n(22153),h=n(66527),y=n(71288),m=n(60136),g=n(16781),p=n(12719),v=n(52987),x=n(84421),j=n(10127);let b=e=>Array.isArray(e)?e.map(e=>b(e)).filter(e=>null!==e):e&&"object"==typeof e?Object.fromEntries(Object.entries(e).map(e=>{let[t,n]=e;return[t,b(n)]}).filter(e=>{let[,t]=e;return null!==t})):e;var k=e=>{let{connectionKey:t}=e,n=(0,r.pmc)(),s=(0,l.T)(),[o]=(0,v.TG)(),[u,c]=(0,a.useState)(""),d=(0,l.C)(j.fD),{data:f,isLoading:k,refetch:_}=(0,x.Eg)(t,{skip:!t}),{data:w,refetch:C}=(0,x.tW)({connectionKey:t,datasetKey:(null==d?void 0:d.fides_key)||""},{skip:!t||!(null==d?void 0:d.fides_key)}),E=(0,a.useMemo)(()=>((null==f?void 0:f.items)||[]).map(e=>({value:e.fides_key,label:e.fides_key})),[null==f?void 0:f.items]);(0,a.useEffect)(()=>{if((null==f?void 0:f.items.length)&&(!d||!f.items.find(e=>e.fides_key===d.fides_key))){let e=f.items[0];s((0,j.w7)(e))}},[f,d,s]),(0,a.useEffect)(()=>{(null==d?void 0:d.ctl_dataset)&&c(h.ZP.dump(b(null==d?void 0:d.ctl_dataset)))},[d]),(0,a.useEffect)(()=>{t&&(null==d?void 0:d.fides_key)&&C()},[t,d,C]);let T=async e=>{let t=null==f?void 0:f.items.find(t=>t.fides_key===e);t&&s((0,j.w7)(t))},S=async()=>{let e;if(!d)return;try{e=h.ZP.load(u)}catch(e){n((0,g.Vo)("YAML Parsing Error: ".concat(e instanceof h._L?"".concat(e.reason," ").concat(e.mark?"at line ".concat(e.mark.line):""):"Invalid YAML format")));return}let t=await o(e);if((0,m.D4)(t)){n((0,g.Vo)((0,m.e$)(t.error)));return}s((0,j.w7)({fides_key:d.fides_key,ctl_dataset:t.data})),n((0,g.t5)("Successfully modified dataset")),await _()},A=async()=>{try{let{data:e}=await _(),t=null==e?void 0:e.items.find(e=>e.fides_key===(null==d?void 0:d.fides_key));(null==t?void 0:t.ctl_dataset)&&c(h.ZP.dump(b(t.ctl_dataset))),n((0,g.t5)("Successfully refreshed datasets"))}catch(e){n((0,g.Vo)((0,m.e$)(e)))}};return(0,i.jsxs)(r.gCW,{alignItems:"stretch",flex:"1",maxWidth:"70vw",maxHeight:"100vh",children:[(0,i.jsxs)(r.X6q,{as:"h3",size:"sm",display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsxs)(r.Ugi,{children:[(0,i.jsx)(r.xvT,{children:"Edit dataset: "}),(0,i.jsx)(r.WPr,{id:"format","data-testid":"export-format-select",value:(null==d?void 0:d.fides_key)||"",options:E,onChange:T,className:"w-64"}),(0,i.jsx)(y.Z,{copyText:u})]}),(0,i.jsxs)(r.Ugi,{spacing:2,children:[(0,i.jsx)(r.wpx,{htmlType:"submit",size:"small","data-testid":"refresh-btn",onClick:A,loading:k,children:"Refresh"}),(0,i.jsx)(r.wpx,{htmlType:"submit",size:"small",onClick:S,children:"Save"})]})]}),(0,i.jsx)(r.Kqy,{border:"1px solid",borderColor:"gray.200",borderRadius:"md",justifyContent:"space-between",py:4,pr:4,"data-testid":"empty-state",flex:"1 1 auto",minHeight:"200px",children:(0,i.jsx)(p.M,{defaultLanguage:"yaml",value:u,height:"100%",onChange:e=>c(e||""),onMount:()=>{},options:{fontFamily:"Menlo",fontSize:13,minimap:{enabled:!1},readOnly:!1,hideCursorInOverviewRuler:!0,overviewRulerBorder:!1,scrollBeyondLastLine:!1},theme:"light"})}),(0,i.jsx)(r.Kqy,{backgroundColor:(null==w?void 0:w.reachable)?"green.50":"red.50",border:"1px solid",borderColor:(null==w?void 0:w.reachable)?"green.500":"red.500",borderRadius:"md",p:2,flexShrink:0,mt:2,children:(0,i.jsx)(r.Ugi,{alignItems:"center",children:(0,i.jsxs)(r.Ugi,{flex:"1",children:[(null==w?void 0:w.reachable)?(0,i.jsx)(r.StI,{}):(0,i.jsx)(r.f9v,{}),(0,i.jsx)(r.xvT,{fontSize:"sm",whiteSpace:"pre-wrap",children:(null==w?void 0:w.reachable)?"Dataset is reachable":"Dataset is not reachable. ".concat(null==w?void 0:w.details)})]})})})]})},_=n(45007),w=n(39514),C=n(27365),E=n(10284),T=n(43073),S=e=>{let{connectionKey:t}=e,n=(0,r.pmc)(),s=(0,l.T)(),[o]=(0,x.s7)(),u=(0,_.v9)(j.fD),c=(0,_.v9)(j.Af),d=(0,_.v9)(j.zn),f=(0,_.v9)(j.M_),h=(0,_.v9)(j.HN),[p,v]=(0,a.useState)("{}");(0,a.useEffect)(()=>{u&&v(JSON.stringify(d,null,2))},[u,d]);let{data:b}=(0,C.Z2)({privacy_request_id:h},{skip:!h||!(null==u?void 0:u.fides_key),pollingInterval:2e3}),{refetch:k}=(0,x.I1)({connectionKey:t,datasetKey:(null==u?void 0:u.fides_key)||""},{skip:!t||!(null==u?void 0:u.fides_key),refetchOnMountOrArgChange:!0});(0,a.useEffect)(()=>{let e=null==u?void 0:u.fides_key;t&&e&&k().then(t=>{t.data&&(null==u?void 0:u.fides_key)===e&&s((0,j.qD)({datasetKey:e,values:t.data}))})},[u,t,s,k]),(0,a.useEffect)(()=>{let e=null==u?void 0:u.fides_key;if(!b||b.privacy_request_id!==h||!e)return;let t={datasetKey:e,values:JSON.stringify(b,null,2)};b.status===E.q2.COMPLETE?f&&(s((0,j.EO)(t)),s((0,j.hT)()),n((0,g.t5)("Test run completed successfully"))):b.status===E.q2.ERROR&&(s((0,j.EO)(t)),s((0,j.hT)()),n((0,g.Vo)("Test run failed")))},[b,h,u,f,s,n]);let S=async()=>{if(null==u?void 0:u.fides_key)try{let e;try{e=JSON.parse(p)}catch(e){n((0,g.Vo)("Invalid JSON in test input"));return}s((0,j.Vh)(u.fides_key));let i=await o({connection_key:t,dataset_key:u.fides_key,input_data:e});(0,T.D4)(i)?(n((0,g.Vo)((0,m.e$)(i.error))),s((0,j.hT)())):"data"in i?s((0,j.eY)(i.data.privacy_request_id)):(s((0,j.hT)()),n((0,g.Vo)("No privacy request ID in response")))}catch(e){s((0,j.hT)()),n((0,g.Vo)("Failed to start test run"))}};return(0,i.jsxs)(r.gCW,{alignItems:"stretch",flex:"1",maxWidth:"70vw",minHeight:"0",children:[(0,i.jsxs)(r.X6q,{as:"h3",size:"sm",display:"flex",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsxs)(r.Ugi,{children:[(0,i.jsx)(r.xvT,{children:"Test inputs (identities and references)"}),(0,i.jsx)(y.Z,{copyText:p})]}),(0,i.jsxs)(r.Ugi,{children:[(0,i.jsx)(w.Z,{label:"Run a test access request using the provided test input data"}),(0,i.jsx)(r.wpx,{htmlType:"submit",size:"small",type:"primary","data-testid":"run-btn",onClick:S,loading:f,children:"Run"})]})]}),(0,i.jsx)(r.gxH,{size:"sm",focusBorderColor:"primary.600",color:"gray.800",isDisabled:f,height:"100%",value:p,onChange:e=>{let t=e.target.value;v(t);try{let e=JSON.parse(t);u&&s((0,j.qD)({datasetKey:u.fides_key,values:e}))}catch(e){}}}),(0,i.jsxs)(r.X6q,{as:"h3",size:"sm",children:["Test results ",(0,i.jsx)(y.Z,{copyText:c})]}),(0,i.jsx)(r.gxH,{isReadOnly:!0,size:"sm",focusBorderColor:"primary.600",color:"gray.800",isDisabled:!1,height:"100%",value:c})]})};let A=e=>e.id?Array.isArray(e.id)?e.id[0]:e.id:"";var N=()=>{var e;let t=(0,s.useRouter)(),n=(0,l.T)(),h=A(t.query),{data:y,isLoading:m}=(0,f.rn)(h,{skip:!h}),g=(null==y?void 0:null===(e=y.connection_configs)||void 0===e?void 0:e.key)||"";return((0,a.useEffect)(()=>{n((0,f.db)(y))},[y,n]),m)?(0,i.jsx)(u.Z,{title:"Systems",children:(0,i.jsx)(o.Z,{})}):(0,i.jsxs)(u.Z,{title:"System inventory",mainProps:{paddingTop:0,height:"100vh",display:"flex",flexDirection:"column"},children:[(0,i.jsx)(d.Z,{breadcrumbs:[{title:"System inventory",link:c.So},{title:(null==y?void 0:y.name)||"",link:"/systems/configure/".concat(h,"#integrations")},{title:"Test datasets"}],isSticky:!0,children:(0,i.jsx)(r.xuv,{position:"relative"})}),(0,i.jsxs)(r.Ugi,{alignItems:"stretch",flex:"1",minHeight:"0",spacing:"4",padding:"4 4 4 0",children:[(0,i.jsx)(k,{connectionKey:g}),(0,i.jsx)(S,{connectionKey:g})]})]})}},41164:function(e,t,n){"use strict";n.d(t,{Bw:function(){return a},D4:function(){return r},Dy:function(){return o},XD:function(){return u},cz:function(){return c},hE:function(){return l},oK:function(){return s}});var i=n(76649);let r=e=>"error"in e,s=e=>(0,i.Ln)({status:"string"},e)&&"PARSING_ERROR"===e.status,a=e=>(0,i.Ln)({status:"number",data:{}},e),l=e=>(0,i.Ln)({detail:"string"},e),o=e=>(0,i.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),u=e=>(0,i.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),c=e=>(0,i.Ln)({detail:[{loc:["string","number"],msg:"string",type:"string"}]},e)},43073:function(e,t,n){"use strict";n.d(t,{Bw:function(){return i.Bw},D4:function(){return i.D4}});var i=n(41164)},76649:function(e,t,n){"use strict";n.d(t,{Ln:function(){return i}});let i=(e,t)=>s(e,t),r=Symbol("SOME"),s=(e,t)=>"string"==typeof e?e===typeof t:Array.isArray(e)?r in e?e.some(e=>s(e,t)):!!Array.isArray(t)&&(0===e.length||t.every(t=>e.some(e=>s(e,t)))):"object"==typeof t&&null!==t&&Object.entries(e).every(([e,n])=>s(n,t[e]));class a{static narrow(e){return new a(t=>i(e,t))}constructor(e){this.NF=void 0,this.NF=e}satisfied(e){return this.NF(e)}build(e){return e}and(e){let t=this.NF,n=e instanceof a?e.NF:e instanceof Function?e:t=>i(e,t);return new a(e=>t(e)&&n(e))}}new a(e=>!0)}},function(e){e.O(0,[3005,2888,9774,179],function(){return e(e.s=54543)}),_N_E=e.O()}]);