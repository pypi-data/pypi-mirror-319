"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5815],{78973:function(e,a,i){i.d(a,{d:function(){return d}});var s=i(24246),n=i(69746),t=i(34090),r=i(27378),l=i(39514),o=i(34803);let d=e=>{let{name:a,label:i,labelProps:d,tooltip:c,isRequired:u,layout:p="inline",...v}=e,[m,g,{setValue:h}]=(0,t.U$)(a),x=!!(g.touched&&g.error),[_,y]=(0,r.useState)("");m.value||"tags"!==v.mode&&"multiple"!==v.mode||(m.value=[]),"tags"===v.mode&&"string"==typeof m.value&&(m.value=[m.value]);let f="tags"===v.mode?(e,a)=>e?e.value!==_||m.value.includes(_)?v.optionRender?v.optionRender(e,a):e.label:'Create "'.concat(_,'"'):void 0:v.optionRender||void 0,j=e=>{y(e),v.onSearch&&v.onSearch(e)},b=(e,a)=>{h(e),v.onChange&&v.onChange(e,a)};return"inline"===p?(0,s.jsx)(n.NIc,{isInvalid:x,isRequired:u,children:(0,s.jsxs)(n.rjZ,{templateColumns:i?"1fr 3fr":"1fr",children:[i?(0,s.jsx)(o.__,{htmlFor:v.id||a,...d,children:i}):null,(0,s.jsxs)(n.jqI,{align:"center",children:[(0,s.jsxs)(n.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,s.jsx)(n.WPr,{...m,id:v.id||a,"data-testid":"controlled-select-".concat(m.name),...v,optionRender:f,onSearch:"tags"===v.mode?j:void 0,onChange:b,value:m.value||void 0}),(0,s.jsx)(o.Bc,{isInvalid:x,message:g.error,fieldName:m.name})]}),c?(0,s.jsx)(l.Z,{label:c}):null]})]})}):(0,s.jsx)(n.NIc,{isInvalid:x,isRequired:u,children:(0,s.jsxs)(n.gCW,{alignItems:"start",children:[(0,s.jsxs)(n.jqI,{align:"center",children:[i?(0,s.jsx)(o.__,{htmlFor:v.id||a,fontSize:"xs",my:0,mr:1,...d,children:i}):null,c?(0,s.jsx)(l.Z,{label:c}):null]}),(0,s.jsx)(n.WPr,{...m,id:v.id||a,"data-testid":"controlled-select-".concat(m.name),...v,optionRender:f,onSearch:"tags"===v.mode?j:void 0,onChange:b,value:m.value||void 0}),(0,s.jsx)(o.Bc,{isInvalid:x,message:g.error,fieldName:m.name})]})})}},98198:function(e,a,i){var s=i(24246),n=i(69746);a.Z=e=>{let{title:a,children:i,isOpen:t,onClose:r,...l}=e;return(0,s.jsxs)(n.u_l,{isOpen:t,onClose:r,isCentered:!0,scrollBehavior:"inside",size:"xl",...l,children:[(0,s.jsx)(n.ZAr,{}),(0,s.jsxs)(n.hzk,{textAlign:"left",p:0,"data-testid":"add-modal-content",children:[(0,s.jsx)(n.xBx,{p:0,children:(0,s.jsx)(n.xuv,{backgroundColor:"gray.50",px:6,py:4,border:"1px",borderColor:"gray.200",borderTopRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center",children:(0,s.jsx)(n.X6q,{as:"h3",size:"sm",children:a})})}),(0,s.jsx)(n.fef,{pb:4,overflow:"auto",children:i})]})]})}},85815:function(e,a,i){i.d(a,{Z:function(){return S}});var s=i(24246),n=i(69746),t=i(34090),r=i(27378),l=i(59389),o=i(44296),d=i(11596),c=i(34803),u=i(55827),p=i(96878),v=i(22153),m=i(62711),g=i(32141),h=i(56048),x=i(60136),_=i(98198),y=i(16781);let f={name:"",consent_use:"",data_use:"",data_categories:["user"],cookieNames:[],cookies:[]},j=[{label:"Analytics",value:"analytics",description:"Provides analytics for activities such as system and advertising performance reporting, insights and fraud detection."},{label:"Essential",value:"essential",description:"Operates the service or product, including legal obligations, support and basic system operations."},{label:"Functional",value:"functional",description:"Used for specific, necessary, and legitimate purposes."},{label:"Marketing",value:"marketing",description:"Enables marketing, promotion, advertising and sales activities for the product, service, application or system."}],b=e=>j.some(a=>a.value===e.split(".")[0]);var k=i(79851),C=i(94180),w=i(78973);let R=e=>{let{index:a,disabled:i}=e;(0,k.fd)();let r=(0,o.C)(k.oW),{values:l}=(0,t.u6)(),d=r.filter(e=>e.value.split(".")[0]===l.privacy_declarations[a].consent_use);return(0,s.jsxs)(n.gCW,{width:"100%",borderRadius:"4px",border:"1px solid",borderColor:"gray.200",spacing:4,p:4,children:[(0,s.jsx)(w.d,{label:"Consent category",tooltip:"What is the system using the data for. For example, is it for third party advertising or perhaps simply providing system operations.",name:"privacy_declarations.".concat(a,".consent_use"),options:j,layout:"stacked",isRequired:!0,disabled:i}),(0,s.jsx)(w.d,{allowClear:!0,label:"Detailed consent category (optional)",tooltip:"Select a more specific consent category",name:"privacy_declarations.".concat(a,".data_use"),options:d,layout:"stacked",disabled:!l.privacy_declarations[a].consent_use||i}),(0,s.jsx)(w.d,{mode:"tags",label:"Cookie names",name:"privacy_declarations.".concat(a,".cookieNames"),options:[],layout:"stacked",disabled:i,className:"w-full"})]})};var N=e=>{var a,i;let{showSuggestions:l,isCreate:d,disabled:c}=e,{values:u,setFieldValue:v}=(0,t.u6)(),{vendor_id:m}=u,{isLoading:g}=(0,p.Wp)({vendor_id:m},{skip:!l||null==m}),h=(0,o.C)((0,p.cL)(m||""));(0,r.useEffect)(()=>{l&&u.vendor_id&&(null==h?void 0:h.length)?v("privacy_declarations",h.filter(e=>b(e.data_use)).map(e=>(0,C.U)(e)).map(e=>{var a,i,s;return{name:null!==(i=e.name)&&void 0!==i?i:"",consent_use:e.data_use.split(".")[0],data_use:e.data_use,data_categories:e.data_categories,cookieNames:(null===(a=e.cookies)||void 0===a?void 0:a.map(e=>e.name))||[],cookies:null!==(s=e.cookies)&&void 0!==s?s:[]}})):d&&v("privacy_declarations",[f])},[l,d,u.vendor_id,h,v]);let x=(null===(a=u.privacy_declarations[u.privacy_declarations.length-1])||void 0===a?void 0:a.data_use)===f.data_use&&(null===(i=u.privacy_declarations[u.privacy_declarations.length-1])||void 0===i?void 0:i.consent_use)===f.consent_use;return g?(0,s.jsx)(n.$jN,{size:"sm",alignSelf:"center"}):(0,s.jsx)(t.F2,{name:"privacy_declarations",render:e=>(0,s.jsxs)(s.Fragment,{children:[u.privacy_declarations.map((e,a)=>(0,s.jsx)(R,{index:a,disabled:c},e.data_use||a)),(0,s.jsx)(n.wpx,{onClick:()=>e.push(f),size:"small",type:"text",disabled:c||x,"data-testid":"add-data-use-btn",children:"Add data use +"})]})})};let q={name:"",vendor_id:void 0,privacy_declarations:[f]};var S=e=>{let{buttonLabel:a,onButtonClick:i,buttonProps:j}=e,b=(0,n.pmc)(),{isOpen:k,onOpen:C,onClose:w}=(0,n.qY0)(),R=(0,o.T)(),[S]=(0,v.in)(),I=(0,r.useMemo)(()=>l.Ry().shape({name:l.Z_().required().label("Vendor name").test("is-unique","",async(e,a)=>{let{data:i}=await S({page:1,size:10,search:e});return!((null==i?void 0:i.items)||[]).some(a=>a.name===e)||a.createError({message:'You already have a vendor called "'.concat(e,'". Please specify a unique name for this vendor.')})})}),[S]),{tcf:Z,dictionaryService:z}=(0,d.hz)(),{isLoading:F}=(0,p.Rd)(void 0,{skip:!z}),V=(0,o.C)(p.o),W=(0,o.C)(m.gU),[E]=(0,v.f7)(),A=(0,o.C)(m.bN),B=()=>{w(),R((0,m.b3)("initial")),R((0,m.gQ)(!1))},L=(0,r.useRef)(null),P=L.current?L.current.values.vendor_id:void 0,Q=(0,o.C)((0,p.$e)(P||"")),U=async(e,a)=>{let i=e.privacy_declarations.filter(e=>e.consent_use!==f.consent_use).flatMap(e=>{let a=e.cookieNames.map(a=>{let i=e.cookies.find(e=>e.name===a);return null!=i?i:{name:a,path:"/"}}),{cookieNames:i,consent_use:s,...n}=e;return"marketing"!==e.consent_use||e.data_use?{...n,data_use:e.data_use?e.data_use:e.consent_use,cookies:a}:["marketing.advertising.first_party.targeted","marketing.advertising.third_party.targeted"].map(e=>({...n,data_use:e,cookies:a}))}),s={...Q,...e,fides_key:(0,u.E)(e.name),system_type:"",privacy_declarations:i},n=await E(s);if((0,x.D4)(n)){b((0,y.Vo)((0,x.e$)(n.error)));return}b((0,y.t5)("Vendor successfully created!")),a.resetForm(),B()},$=e=>{if(z){if(!e){R((0,m.b3)("hiding")),R((0,m.gQ)(!1));return}R((0,m.b3)("showing")),Z&&(0,x.cj)(e)===x.c6.GVL?R((0,m.gQ)(!0)):R((0,m.gQ)(!1))}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.wpx,{onClick:()=>{i?i():C()},"data-testid":"add-vendor-btn",...j,children:a}),(0,s.jsx)(t.J9,{initialValues:q,enableReinitialize:!0,onSubmit:U,validationSchema:I,innerRef:L,children:e=>{let{dirty:a,isValid:i,resetForm:r}=e;return(0,s.jsx)(_.Z,{isOpen:k,onClose:B,title:"Add a vendor",children:(0,s.jsxs)(n.xuv,{"data-testid":"add-vendor-modal-content",my:4,children:[W?(0,s.jsx)(g.Z,{}):null,(0,s.jsx)(t.l0,{children:(0,s.jsxs)(n.gCW,{alignItems:"start",spacing:6,children:[z?(0,s.jsx)(h.Z,{label:"Vendor name",options:V,isLoading:F,onVendorSelected:$,isCreate:!0,lockedForGVL:W}):(0,s.jsx)(c.j0,{id:"name",name:"name",isRequired:!0,label:"Vendor name",tooltip:"Give the system a unique, and relevant name for reporting purposes. e.g. “Email Data Warehouse”",variant:"stacked"}),(0,s.jsx)(N,{showSuggestions:"showing"===A,isCreate:!0,disabled:W}),(0,s.jsxs)("div",{className:"flex w-full justify-between",children:[(0,s.jsx)(n.wpx,{onClick:()=>{B(),r()},children:"Cancel"}),(0,s.jsx)(n.wpx,{type:"primary",htmlType:"submit",disabled:F||!a||!i,loading:F,"data-testid":"save-btn",children:"Save vendor"})]})]})})]})})}})]})}}}]);