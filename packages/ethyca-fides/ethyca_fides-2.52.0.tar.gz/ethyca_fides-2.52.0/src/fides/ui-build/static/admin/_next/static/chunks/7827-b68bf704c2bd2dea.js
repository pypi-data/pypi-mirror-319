"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7827],{79511:function(e,l,t){t.d(l,{k:function(){return r}});var i=t(76649);let n=e=>(0,i.Ln)({id:"string"},e),r=e=>(null!=e?e:[]).filter(n)},19535:function(e,l,t){t.d(l,{m:function(){return o}});var i=t(27378),n=t(11596),r=t(53359),a=t(96878),s=t(79511);let o=e=>{let{resourceFidesKey:l,resourceType:t}=e,{errorAlert:o}=(0,r.V)(),{plus:d}=(0,n.hz)(),u=(0,i.useMemo)(()=>null!=l?l:"",[]),c=(0,a.YU)(!0,{skip:!d}),m=(0,a.VN)(t,{skip:!d}),{data:p,isLoading:x,error:v,isError:f}=(0,a.PV)(null!=l?l:"",{skip:""!==u&&!(d&&u)}),[h]=(0,a._D)(),_=c.isLoading||m.isLoading||x,g=(0,i.useMemo)(()=>new Map((0,s.k)(c.data).map(e=>{var l;return[e.id,{...e,options:(null!==(l=e.allowed_values)&&void 0!==l?l:[]).map(e=>({value:e,label:e}))}]})),[c.data]),j=(0,i.useMemo)(()=>{var e;return null===(e=m.data)||void 0===e?void 0:e.filter(e=>e.active)},[m.data]),C=(0,i.useMemo)(()=>new Map((0,s.k)(j).map(e=>[e.id,e])),[j]),S=(0,i.useMemo)(()=>f&&(null==v?void 0:v.status)===404?new Map:new Map((0,s.k)(p).map(e=>[e.custom_field_definition_id,e])),[p,f,v]),T=(0,i.useMemo)(()=>{let e=[...C.keys()];return e.sort(),e},[C]),A=(0,i.useMemo)(()=>{let e={};return j&&S&&j.forEach(l=>{let t=S.get(l.id||"");t&&(l.allow_list_id&&"string[]"===l.field_type?e[t.custom_field_definition_id]=t.value:e[t.custom_field_definition_id]=t.value.toString())}),e},[j,S]),E=(0,i.useCallback)(async e=>{if(!d)return;let i="fides_key"in e&&""!==e.fides_key?e.fides_key:l;if(!i)return;let{customFieldValues:n}=e;if(!n||0===Object.keys(n).length)return;let r=[],a=[];T.forEach(e=>{let l=S.get(e),t=n[e];void 0===t||""===t||Array.isArray(t)&&0===t.length?(null==l?void 0:l.id)&&a.push(l.id):r.push({custom_field_definition_id:e,resource_id:i,id:null==l?void 0:l.id,value:t})});try{await h({resource_type:t,resource_id:i,upsert:r,delete:a})}catch(e){o("One or more custom fields have failed to save, please try again."),console.error(e)}},[d,S,o,l,T,h,t]);return{customFieldValues:A,definitionIdToCustomField:S,idToAllowListWithOptions:g,idToCustomFieldDefinition:C,isEnabled:d,isLoading:_,sortedCustomFieldDefinitionIds:T,upsertCustomFields:E}}},37827:function(e,l,t){t.d(l,{uc:function(){return h},Hn:function(){return o},Uv:function(){return a},C7:function(){return d},mZ:function(){return f.m}});var i,n,r,a,s=t(10284);(i=r||(r={}))[i.CREATE_CUSTOM_FIELDS=0]="CREATE_CUSTOM_FIELDS",i[i.CREATE_CUSTOM_LISTS=1]="CREATE_CUSTOM_LISTS",i[i.CHOOSE_FROM_LIBRARY=2]="CHOOSE_FROM_LIBRARY",s.AL.STRING,s.AL.STRING_,(n=a||(a={})).SINGLE_SELECT="singleSelect",n.MULTIPLE_SELECT="multipleSelect",n.OPEN_TEXT="openText";let o=[{label:"Single select",value:"singleSelect"},{label:"Multiple select",value:"multipleSelect"},{label:"Open Text",value:"openText"}],d=[{label:"taxonomy:".concat(s.P6.DATA_CATEGORY),value:s.P6.DATA_CATEGORY},{label:"taxonomy:".concat(s.P6.DATA_SUBJECT),value:s.P6.DATA_SUBJECT},{label:"taxonomy:".concat(s.P6.DATA_USE),value:s.P6.DATA_USE},{label:"".concat(s.P6.SYSTEM,":information"),value:s.P6.SYSTEM},{label:"system:data use",value:s.P6.PRIVACY_DECLARATION}];var u=t(24246),c=t(69746),m=t(34090),p=t(90982),x=t(78973),v=t(34803),f=t(19535);let h=e=>{let{resourceFidesKey:l,resourceType:t}=e,{idToAllowListWithOptions:i,idToCustomFieldDefinition:n,isEnabled:r,isLoading:a,sortedCustomFieldDefinitionIds:o}=(0,f.m)({resourceFidesKey:l,resourceType:t});return r&&0!==o.length?(0,u.jsx)(p.Z,{heading:"Custom fields",children:(0,u.jsx)(c.kCb,{flexDir:"column","data-testid":"custom-fields-list",children:(0,u.jsx)(c.kCb,{flexDir:"column",gap:"24px",children:a?(0,u.jsx)(c.M5Y,{children:(0,u.jsx)(c.$jN,{})}):o.length>0&&(0,u.jsx)(c.kCb,{flexDirection:"column",gap:"12px",paddingBottom:"24px",children:o.map(e=>{let l=n.get(e);if(!l)return null;let t="customFieldValues.".concat(l.id);if(!l.allow_list_id&&l.field_type===s.AL.STRING)return(0,u.jsx)(m.gN,{name:t,children:e=>{let{field:t}=e;return(0,u.jsx)(v.j0,{...t,label:l.name,tooltip:l.description,variant:"stacked"})}},e);let r=i.get(l.allow_list_id);if(!r)return null;let{options:a}=r;return(0,u.jsx)(x.d,{name:t,allowClear:!0,mode:l.field_type!==s.AL.STRING?"multiple":void 0,label:l.name,options:a,tooltip:l.description,layout:"stacked",className:"w-full"},e)})})})})}):null};t(79511),t(27378)},78973:function(e,l,t){t.d(l,{d:function(){return d}});var i=t(24246),n=t(69746),r=t(34090),a=t(27378),s=t(39514),o=t(34803);let d=e=>{let{name:l,label:t,labelProps:d,tooltip:u,isRequired:c,layout:m="inline",...p}=e,[x,v,{setValue:f}]=(0,r.U$)(l),h=!!(v.touched&&v.error),[_,g]=(0,a.useState)("");x.value||"tags"!==p.mode&&"multiple"!==p.mode||(x.value=[]),"tags"===p.mode&&"string"==typeof x.value&&(x.value=[x.value]);let j="tags"===p.mode?(e,l)=>e?e.value!==_||x.value.includes(_)?p.optionRender?p.optionRender(e,l):e.label:'Create "'.concat(_,'"'):void 0:p.optionRender||void 0,C=e=>{g(e),p.onSearch&&p.onSearch(e)},S=(e,l)=>{f(e),p.onChange&&p.onChange(e,l)};return"inline"===m?(0,i.jsx)(n.NIc,{isInvalid:h,isRequired:c,children:(0,i.jsxs)(n.rjZ,{templateColumns:t?"1fr 3fr":"1fr",children:[t?(0,i.jsx)(o.__,{htmlFor:p.id||l,...d,children:t}):null,(0,i.jsxs)(n.jqI,{align:"center",children:[(0,i.jsxs)(n.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,i.jsx)(n.WPr,{...x,id:p.id||l,"data-testid":"controlled-select-".concat(x.name),...p,optionRender:j,onSearch:"tags"===p.mode?C:void 0,onChange:S,value:x.value||void 0}),(0,i.jsx)(o.Bc,{isInvalid:h,message:v.error,fieldName:x.name})]}),u?(0,i.jsx)(s.Z,{label:u}):null]})]})}):(0,i.jsx)(n.NIc,{isInvalid:h,isRequired:c,children:(0,i.jsxs)(n.gCW,{alignItems:"start",children:[(0,i.jsxs)(n.jqI,{align:"center",children:[t?(0,i.jsx)(o.__,{htmlFor:p.id||l,fontSize:"xs",my:0,mr:1,...d,children:t}):null,u?(0,i.jsx)(s.Z,{label:u}):null]}),(0,i.jsx)(n.WPr,{...x,id:p.id||l,"data-testid":"controlled-select-".concat(x.name),...p,optionRender:j,onSearch:"tags"===p.mode?C:void 0,onChange:S,value:x.value||void 0}),(0,i.jsx)(o.Bc,{isInvalid:h,message:v.error,fieldName:x.name})]})})}},53359:function(e,l,t){t.d(l,{H:function(){return r},V:function(){return i.V}});var i=t(75139),n=t(60136);let r=()=>{let{errorAlert:e}=(0,i.V)();return{handleError:l=>{let t="An unexpected error occurred. Please try again.";(0,n.Ot)(l)?t=l.data.detail:(0,n.tB)(l)&&(t=l.data.detail[0].msg),e(t)}}}},75139:function(e,l,t){t.d(l,{V:function(){return r}});var i=t(24246),n=t(69746);let r=()=>{let e=(0,n.pmc)();return{errorAlert:(l,t,r)=>{let a={...r,position:(null==r?void 0:r.position)||"top",render:e=>{let{onClose:r}=e;return(0,i.jsxs)(n.bZj,{alignItems:"normal",status:"error",children:[(0,i.jsx)(n.zMQ,{}),(0,i.jsxs)(n.xuv,{children:[t&&(0,i.jsx)(n.CdC,{children:t}),(0,i.jsx)(n.XaZ,{children:l})]}),(0,i.jsx)(n.PZ7,{onClick:r,position:"relative",right:0,size:"sm",top:-1})]})}};(null==r?void 0:r.id)&&e.isActive(r.id)?e.update(r.id,a):e(a)},successAlert:(l,t,r)=>{let a={...r,position:(null==r?void 0:r.position)||"top",render:e=>{let{onClose:r}=e;return(0,i.jsxs)(n.bZj,{alignItems:"normal",status:"success",variant:"subtle",children:[(0,i.jsx)(n.zMQ,{}),(0,i.jsxs)(n.xuv,{children:[t&&(0,i.jsx)(n.CdC,{children:t}),(0,i.jsx)(n.XaZ,{children:l})]}),(0,i.jsx)(n.PZ7,{onClick:r,position:"relative",right:0,size:"sm",top:-1})]})}};(null==r?void 0:r.id)&&e.isActive(r.id)?e.update(r.id,a):e(a)}}}},90982:function(e,l,t){var i=t(24246),n=t(69746);l.Z=e=>{let{heading:l,HeadingButton:t,children:r}=e;return(0,i.jsx)(n.Kqy,{spacing:4,children:(0,i.jsxs)(n.xuv,{maxWidth:"720px",border:"1px",borderColor:"gray.200",borderRadius:6,overflow:"visible",mt:6,children:[(0,i.jsxs)(n.xuv,{backgroundColor:"gray.50",px:6,py:4,display:"flex",flexDirection:"row",alignItems:"center",borderBottom:"1px",borderColor:"gray.200",borderTopRadius:6,children:[(0,i.jsx)(n.X6q,{as:"h3",size:"xs",children:l}),t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.LZC,{}),(0,i.jsx)(t,{})]}):null]}),(0,i.jsx)(n.Kqy,{spacing:4,px:6,py:6,children:r})]})})}}}]);